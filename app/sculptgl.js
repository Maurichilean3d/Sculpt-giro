/*! For license information please see sculptgl.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.sculptgl=e():t.sculptgl=e()}(self,(function(){return(()=>{var t={750:(t,e,i)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function a(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=y();return function(){var i,r=p(t);if(e){var n=p(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return c(this,i)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e,i){return e&&m(t.prototype,e),i&&m(t,i),t}i.r(e),i(50);var _=1001,b=2300,k=2301,x=2302,M="srgb",w="srgb-linear",A="linear",T="srgb",S=35044,E=35048,C=2e3,R=2001;function I(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;var N={};function z(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var r,n="THREE."+e.shift();(r=console).warn.apply(r,[n].concat(e))}function O(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var r,n="THREE."+e.shift();(r=console).error.apply(r,[n].concat(e))}function F(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var r=e.join(" ");r in N||(N[r]=!0,z.apply(void 0,e))}var P=function(){function t(){v(this,t)}return g(t,[{key:"addEventListener",value:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)}},{key:"hasEventListener",value:function(t,e){var i=this._listeners;return void 0!==i&&void 0!==i[t]&&-1!==i[t].indexOf(e)}},{key:"removeEventListener",value:function(t,e){var i=this._listeners;if(void 0!==i){var r=i[t];if(void 0!==r){var n=r.indexOf(e);-1!==n&&r.splice(n,1)}}}},{key:"dispatchEvent",value:function(t){var e=this._listeners;if(void 0!==e){var i=e[t.type];if(void 0!==i){t.target=this;for(var r=i.slice(0),n=0,s=r.length;n<s;n++)r[n].call(this,t);t.target=null}}}}]),t}(),V=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function D(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(V[255&t]+V[t>>8&255]+V[t>>16&255]+V[t>>24&255]+"-"+V[255&e]+V[e>>8&255]+"-"+V[e>>16&15|64]+V[e>>24&255]+"-"+V[63&i|128]+V[i>>8&255]+"-"+V[i>>16&255]+V[i>>24&255]+V[255&r]+V[r>>8&255]+V[r>>16&255]+V[r>>24&255]).toLowerCase()}function U(t,e,i){return Math.max(e,Math.min(i,t))}function L(t,e){return(t%e+e)%e}function W(t,e,i){return(1-i)*t+i*e}function B(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function j(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}Math.PI,Math.PI;var X=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;v(this,t),t.prototype.isVector2=!0,this.x=e,this.y=i}return g(t,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setComponent",value:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}},{key:"addScaledVector",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"applyMatrix3",value:function(t){var e=this.x,i=this.y,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6],this.y=r[1]*e+r[4]*i+r[7],this}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}},{key:"clamp",value:function(t,e){return this.x=U(this.x,t.x,e.x),this.y=U(this.y,t.y,e.y),this}},{key:"clampScalar",value:function(t,e){return this.x=U(this.x,t,e),this.y=U(this.y,t,e),this}},{key:"clampLength",value:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(U(i,t,e))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(t){return this.x*t.y-this.y*t.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){return Math.atan2(-this.y,-this.x)+Math.PI}},{key:"angleTo",value:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var i=this.dot(t)/e;return Math.acos(U(i,-1,1))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}},{key:"lerpVectors",value:function(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t}},{key:"fromBufferAttribute",value:function(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}},{key:"rotateAround",value:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=this.x-t.x,s=this.y-t.y;return this.x=n*i-s*r+t.x,this.y=n*r+s*i+t.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:Symbol.iterator,value:regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.x;case 2:return t.next=4,this.y;case 4:case"end":return t.stop()}}),t,this)}))}]),t}(),Y=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;v(this,t),this.isQuaternion=!0,this._x=e,this._y=i,this._z=r,this._w=n}return g(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}},{key:"set",value:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t._x,r=t._y,n=t._z,s=t._order,a=Math.cos,o=Math.sin,u=a(i/2),h=a(r/2),l=a(n/2),c=o(i/2),f=o(r/2),y=o(n/2);switch(s){case"XYZ":this._x=c*h*l+u*f*y,this._y=u*f*l-c*h*y,this._z=u*h*y+c*f*l,this._w=u*h*l-c*f*y;break;case"YXZ":this._x=c*h*l+u*f*y,this._y=u*f*l-c*h*y,this._z=u*h*y-c*f*l,this._w=u*h*l+c*f*y;break;case"ZXY":this._x=c*h*l-u*f*y,this._y=u*f*l+c*h*y,this._z=u*h*y+c*f*l,this._w=u*h*l-c*f*y;break;case"ZYX":this._x=c*h*l-u*f*y,this._y=u*f*l+c*h*y,this._z=u*h*y-c*f*l,this._w=u*h*l+c*f*y;break;case"YZX":this._x=c*h*l+u*f*y,this._y=u*f*l+c*h*y,this._z=u*h*y-c*f*l,this._w=u*h*l-c*f*y;break;case"XZY":this._x=c*h*l-u*f*y,this._y=u*f*l-c*h*y,this._z=u*h*y+c*f*l,this._w=u*h*l+c*f*y;break;default:z("Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===e&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(t,e){var i=e/2,r=Math.sin(i);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(t){var e=t.elements,i=e[0],r=e[4],n=e[8],s=e[1],a=e[5],o=e[9],u=e[2],h=e[6],l=e[10],c=i+a+l;if(c>0){var f=.5/Math.sqrt(c+1);this._w=.25/f,this._x=(h-o)*f,this._y=(n-u)*f,this._z=(s-r)*f}else if(i>a&&i>l){var y=2*Math.sqrt(1+i-a-l);this._w=(h-o)/y,this._x=.25*y,this._y=(r+s)/y,this._z=(n+u)/y}else if(a>l){var p=2*Math.sqrt(1+a-i-l);this._w=(n-u)/p,this._x=(r+s)/p,this._y=.25*p,this._z=(o+h)/p}else{var d=2*Math.sqrt(1+l-i-a);this._w=(s-r)/d,this._x=(n+u)/d,this._y=(o+h)/d,this._z=.25*d}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(t,e){var i=t.dot(e)+1;return i<1e-8?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}},{key:"angleTo",value:function(t){return 2*Math.acos(Math.abs(U(this.dot(t),-1,1)))}},{key:"rotateTowards",value:function(t,e){var i=this.angleTo(t);if(0===i)return this;var r=Math.min(1,e/i);return this.slerp(t,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}},{key:"multiply",value:function(t){return this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"multiplyQuaternions",value:function(t,e){var i=t._x,r=t._y,n=t._z,s=t._w,a=e._x,o=e._y,u=e._z,h=e._w;return this._x=i*h+s*a+r*u-n*o,this._y=r*h+s*o+n*a-i*u,this._z=n*h+s*u+i*o-r*a,this._w=s*h-i*a-r*o-n*u,this._onChangeCallback(),this}},{key:"slerp",value:function(t,e){if(e<=0)return this;if(e>=1)return this.copy(t);var i=t._x,r=t._y,n=t._z,s=t._w,a=this.dot(t);a<0&&(i=-i,r=-r,n=-n,s=-s,a=-a);var o=1-e;if(a<.9995){var u=Math.acos(a),h=Math.sin(u);o=Math.sin(o*u)/h,e=Math.sin(e*u)/h,this._x=this._x*o+i*e,this._y=this._y*o+r*e,this._z=this._z*o+n*e,this._w=this._w*o+s*e,this._onChangeCallback()}else this._x=this._x*o+i*e,this._y=this._y*o+r*e,this._z=this._z*o+n*e,this._w=this._w*o+s*e,this.normalize();return this}},{key:"slerpQuaternions",value:function(t,e,i){return this.copy(t).slerp(e,i)}},{key:"random",value:function(){var t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),n=Math.sqrt(i);return this.set(r*Math.sin(t),r*Math.cos(t),n*Math.sin(e),n*Math.cos(e))}},{key:"equals",value:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}},{key:"fromBufferAttribute",value:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}},{key:"toJSON",value:function(){return this.toArray()}},{key:"_onChange",value:function(t){return this._onChangeCallback=t,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._x;case 2:return t.next=4,this._y;case 4:return t.next=6,this._z;case 6:return t.next=8,this._w;case 8:case"end":return t.stop()}}),t,this)}))}],[{key:"slerpFlat",value:function(t,e,i,r,n,s,a){var o=i[r+0],u=i[r+1],h=i[r+2],l=i[r+3],c=n[s+0],f=n[s+1],y=n[s+2],p=n[s+3];if(a<=0)return t[e+0]=o,t[e+1]=u,t[e+2]=h,void(t[e+3]=l);if(a>=1)return t[e+0]=c,t[e+1]=f,t[e+2]=y,void(t[e+3]=p);if(l!==p||o!==c||u!==f||h!==y){var d=o*c+u*f+h*y+l*p;d<0&&(c=-c,f=-f,y=-y,p=-p,d=-d);var v=1-a;if(d<.9995){var m=Math.acos(d),g=Math.sin(m);o=o*(v=Math.sin(v*m)/g)+c*(a=Math.sin(a*m)/g),u=u*v+f*a,h=h*v+y*a,l=l*v+p*a}else{o=o*v+c*a,u=u*v+f*a,h=h*v+y*a,l=l*v+p*a;var _=1/Math.sqrt(o*o+u*u+h*h+l*l);o*=_,u*=_,h*=_,l*=_}}t[e]=o,t[e+1]=u,t[e+2]=h,t[e+3]=l}},{key:"multiplyQuaternionsFlat",value:function(t,e,i,r,n,s){var a=i[r],o=i[r+1],u=i[r+2],h=i[r+3],l=n[s],c=n[s+1],f=n[s+2],y=n[s+3];return t[e]=a*y+h*l+o*f-u*c,t[e+1]=o*y+h*c+u*l-a*f,t[e+2]=u*y+h*f+a*c-o*l,t[e+3]=h*y-a*l-o*c-u*f,t}}]),t}(),H=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;v(this,t),t.prototype.isVector3=!0,this.x=e,this.y=i,this.z=r}return g(t,[{key:"set",value:function(t,e,i){return void 0===i&&(i=this.z),this.x=t,this.y=e,this.z=i,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}},{key:"addScaledVector",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}},{key:"applyEuler",value:function(t){return this.applyQuaternion(G.setFromEuler(t))}},{key:"applyAxisAngle",value:function(t,e){return this.applyQuaternion(G.setFromAxisAngle(t,e))}},{key:"applyMatrix3",value:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6]*r,this.y=n[1]*e+n[4]*i+n[7]*r,this.z=n[2]*e+n[5]*i+n[8]*r,this}},{key:"applyNormalMatrix",value:function(t){return this.applyMatrix3(t).normalize()}},{key:"applyMatrix4",value:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements,s=1/(n[3]*e+n[7]*i+n[11]*r+n[15]);return this.x=(n[0]*e+n[4]*i+n[8]*r+n[12])*s,this.y=(n[1]*e+n[5]*i+n[9]*r+n[13])*s,this.z=(n[2]*e+n[6]*i+n[10]*r+n[14])*s,this}},{key:"applyQuaternion",value:function(t){var e=this.x,i=this.y,r=this.z,n=t.x,s=t.y,a=t.z,o=t.w,u=2*(s*r-a*i),h=2*(a*e-n*r),l=2*(n*i-s*e);return this.x=e+o*u+s*l-a*h,this.y=i+o*h+a*u-n*l,this.z=r+o*l+n*h-s*u,this}},{key:"project",value:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}},{key:"unproject",value:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}},{key:"transformDirection",value:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[4]*i+n[8]*r,this.y=n[1]*e+n[5]*i+n[9]*r,this.z=n[2]*e+n[6]*i+n[10]*r,this.normalize()}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,e){return this.x=U(this.x,t.x,e.x),this.y=U(this.y,t.y,e.y),this.z=U(this.z,t.z,e.z),this}},{key:"clampScalar",value:function(t,e){return this.x=U(this.x,t,e),this.y=U(this.y,t,e),this.z=U(this.z,t,e),this}},{key:"clampLength",value:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(U(i,t,e))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}},{key:"lerpVectors",value:function(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}},{key:"cross",value:function(t){return this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,e){var i=t.x,r=t.y,n=t.z,s=e.x,a=e.y,o=e.z;return this.x=r*o-n*a,this.y=n*s-i*o,this.z=i*a-r*s,this}},{key:"projectOnVector",value:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}},{key:"projectOnPlane",value:function(t){return q.copy(this).projectOnVector(t),this.sub(q)}},{key:"reflect",value:function(t){return this.sub(q.copy(t).multiplyScalar(2*this.dot(t)))}},{key:"angleTo",value:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var i=this.dot(t)/e;return Math.acos(U(i,-1,1))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var e=this.x-t.x,i=this.y-t.y,r=this.z-t.z;return e*e+i*i+r*r}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"setFromSpherical",value:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}},{key:"setFromSphericalCoords",value:function(t,e,i){var r=Math.sin(e)*t;return this.x=r*Math.sin(i),this.y=Math.cos(e)*t,this.z=r*Math.cos(i),this}},{key:"setFromCylindrical",value:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}},{key:"setFromCylindricalCoords",value:function(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}},{key:"setFromMatrixPosition",value:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}},{key:"setFromMatrixScale",value:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=r,this}},{key:"setFromMatrixColumn",value:function(t,e){return this.fromArray(t.elements,4*e)}},{key:"setFromMatrix3Column",value:function(t,e){return this.fromArray(t.elements,3*e)}},{key:"setFromEuler",value:function(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}},{key:"setFromColor",value:function(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}},{key:"fromBufferAttribute",value:function(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var t=Math.random()*Math.PI*2,e=2*Math.random()-1,i=Math.sqrt(1-e*e);return this.x=i*Math.cos(t),this.y=e,this.z=i*Math.sin(t),this}},{key:Symbol.iterator,value:regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.x;case 2:return t.next=4,this.y;case 4:return t.next=6,this.z;case 6:case"end":return t.stop()}}),t,this)}))}]),t}(),q=new H,G=new Y,Z=function(){function t(e,i,r,n,s,a,o,u,h){v(this,t),t.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,i,r,n,s,a,o,u,h)}return g(t,[{key:"set",value:function(t,e,i,r,n,s,a,o,u){var h=this.elements;return h[0]=t,h[1]=r,h[2]=a,h[3]=e,h[4]=n,h[5]=o,h[6]=i,h[7]=s,h[8]=u,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}},{key:"extractBasis",value:function(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}},{key:"multiply",value:function(t){return this.multiplyMatrices(this,t)}},{key:"premultiply",value:function(t){return this.multiplyMatrices(t,this)}},{key:"multiplyMatrices",value:function(t,e){var i=t.elements,r=e.elements,n=this.elements,s=i[0],a=i[3],o=i[6],u=i[1],h=i[4],l=i[7],c=i[2],f=i[5],y=i[8],p=r[0],d=r[3],v=r[6],m=r[1],g=r[4],_=r[7],b=r[2],k=r[5],x=r[8];return n[0]=s*p+a*m+o*b,n[3]=s*d+a*g+o*k,n[6]=s*v+a*_+o*x,n[1]=u*p+h*m+l*b,n[4]=u*d+h*g+l*k,n[7]=u*v+h*_+l*x,n[2]=c*p+f*m+y*b,n[5]=c*d+f*g+y*k,n[8]=c*v+f*_+y*x,this}},{key:"multiplyScalar",value:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}},{key:"determinant",value:function(){var t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],a=t[5],o=t[6],u=t[7],h=t[8];return e*s*h-e*a*u-i*n*h+i*a*o+r*n*u-r*s*o}},{key:"invert",value:function(){var t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],a=t[5],o=t[6],u=t[7],h=t[8],l=h*s-a*u,c=a*o-h*n,f=u*n-s*o,y=e*l+i*c+r*f;if(0===y)return this.set(0,0,0,0,0,0,0,0,0);var p=1/y;return t[0]=l*p,t[1]=(r*u-h*i)*p,t[2]=(a*i-r*s)*p,t[3]=c*p,t[4]=(h*e-r*o)*p,t[5]=(r*n-a*e)*p,t[6]=f*p,t[7]=(i*o-u*e)*p,t[8]=(s*e-i*n)*p,this}},{key:"transpose",value:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}},{key:"getNormalMatrix",value:function(t){return this.setFromMatrix4(t).invert().transpose()}},{key:"transposeIntoArray",value:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}},{key:"setUvTransform",value:function(t,e,i,r,n,s,a){var o=Math.cos(n),u=Math.sin(n);return this.set(i*o,i*u,-i*(o*s+u*a)+s+t,-r*u,r*o,-r*(-u*s+o*a)+a+e,0,0,1),this}},{key:"scale",value:function(t,e){return this.premultiply(K.makeScale(t,e)),this}},{key:"rotate",value:function(t){return this.premultiply(K.makeRotation(-t)),this}},{key:"translate",value:function(t,e){return this.premultiply(K.makeTranslation(t,e)),this}},{key:"makeTranslation",value:function(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}},{key:"makeRotation",value:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,i,e,0,0,0,1),this}},{key:"makeScale",value:function(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}},{key:"equals",value:function(t){for(var e=this.elements,i=t.elements,r=0;r<9;r++)if(e[r]!==i[r])return!1;return!0}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0;i<9;i++)this.elements[i]=t[i+e];return this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),t}(),K=new Z,J=(new Z).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Q=(new Z).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function $(){var t,e={enabled:!0,workingColorSpace:w,spaces:{},convert:function(t,e,i){return!1!==this.enabled&&e!==i&&e&&i?(this.spaces[e].transfer===T&&(t.r=it(t.r),t.g=it(t.g),t.b=it(t.b)),this.spaces[e].primaries!==this.spaces[i].primaries&&(t.applyMatrix3(this.spaces[e].toXYZ),t.applyMatrix3(this.spaces[i].fromXYZ)),this.spaces[i].transfer===T&&(t.r=rt(t.r),t.g=rt(t.g),t.b=rt(t.b)),t):t},workingToColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},colorSpaceToWorking:function(t,e){return this.convert(t,e,this.workingColorSpace)},getPrimaries:function(t){return this.spaces[t].primaries},getTransfer:function(t){return""===t?A:this.spaces[t].transfer},getToneMappingMode:function(t){return this.spaces[t].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return t.fromArray(this.spaces[e].luminanceCoefficients)},define:function(t){Object.assign(this.spaces,t)},_getMatrix:function(t,e,i){return t.copy(this.spaces[e].toXYZ).multiply(this.spaces[i].fromXYZ)},_getDrawingBufferColorSpace:function(t){return this.spaces[t].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[t].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,i){return F("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,i)},toWorkingColorSpace:function(t,i){return F("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,i)}},i=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],n=[.3127,.329];return e.define((d(t={},w,{primaries:i,whitePoint:n,transfer:A,toXYZ:J,fromXYZ:Q,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:M},outputColorSpaceConfig:{drawingBufferColorSpace:M}}),d(t,M,{primaries:i,whitePoint:n,transfer:T,toXYZ:J,fromXYZ:Q,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:M}}),t)),e}var tt,et=$();function it(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function rt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var nt=function(){function t(){v(this,t)}return g(t,null,[{key:"getDataURL",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===tt&&(tt=I("canvas")),tt.width=t.width,tt.height=t.height;var r=tt.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),e=tt}return e.toDataURL(i)}},{key:"sRGBToLinear",value:function(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var e=I("canvas");e.width=t.width,e.height=t.height;var i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);for(var r=i.getImageData(0,0,t.width,t.height),n=r.data,s=0;s<n.length;s++)n[s]=255*it(n[s]/255);return i.putImageData(r,0,0),e}if(t.data){for(var a=t.data.slice(0),o=0;o<a.length;o++)a instanceof Uint8Array||a instanceof Uint8ClampedArray?a[o]=Math.floor(255*it(a[o]/255)):a[o]=it(a[o]);return{data:a,width:t.width,height:t.height}}return z("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}]),t}(),st=0,at=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;v(this,t),this.isSource=!0,Object.defineProperty(this,"id",{value:st++}),this.uuid=D(),this.data=e,this.dataReady=!0,this.version=0}return g(t,[{key:"getSize",value:function(t){var e=this.data;return"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?t.set(e.videoWidth,e.videoHeight,0):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?t.set(e.displayHeight,e.displayWidth,0):null!==e?t.set(e.width,e.height,e.depth||0):t.set(0,0,0),t}},{key:"needsUpdate",set:function(t){!0===t&&this.version++}},{key:"toJSON",value:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];var i={uuid:this.uuid,url:""},r=this.data;if(null!==r){var n;if(Array.isArray(r)){n=[];for(var s=0,a=r.length;s<a;s++)r[s].isDataTexture?n.push(ot(r[s].image)):n.push(ot(r[s]))}else n=ot(r);i.url=n}return e||(t.images[this.uuid]=i),i}}]),t}();function ot(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?nt.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(z("Texture: Unable to serialize Texture."),{})}var ut=0,ht=new H,lt=function(t){u(i,t);var e=l(i);function i(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.DEFAULT_IMAGE,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.DEFAULT_MAPPING,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1006,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1008,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1023,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1009,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:i.DEFAULT_ANISOTROPY,y=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";return v(this,i),(t=e.call(this)).isTexture=!0,Object.defineProperty(f(t),"id",{value:ut++}),t.uuid=D(),t.name="",t.source=new at(r),t.mipmaps=[],t.mapping=n,t.channel=0,t.wrapS=s,t.wrapT=a,t.magFilter=o,t.minFilter=u,t.anisotropy=c,t.format=h,t.internalFormat=null,t.type=l,t.offset=new X(0,0),t.repeat=new X(1,1),t.center=new X(0,0),t.rotation=0,t.matrixAutoUpdate=!0,t.matrix=new Z,t.generateMipmaps=!0,t.premultiplyAlpha=!1,t.flipY=!0,t.unpackAlignment=4,t.colorSpace=y,t.userData={},t.updateRanges=[],t.version=0,t.onUpdate=null,t.renderTarget=null,t.isRenderTargetTexture=!1,t.isArrayTexture=!!(r&&r.depth&&r.depth>1),t.pmremVersion=0,t}return g(i,[{key:"width",get:function(){return this.source.getSize(ht).x}},{key:"height",get:function(){return this.source.getSize(ht).y}},{key:"depth",get:function(){return this.source.getSize(ht).z}},{key:"image",get:function(){return this.source.data},set:function(t){void 0===t&&(t=null),this.source.data=t}},{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"addUpdateRange",value:function(t,e){this.updateRanges.push({start:t,count:e})}},{key:"clearUpdateRanges",value:function(){this.updateRanges.length=0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}},{key:"setValues",value:function(t){for(var e in t){var i=t[e];if(void 0!==i){var r=this[e];void 0!==r?r&&i&&r.isVector2&&i.isVector2||r&&i&&r.isVector3&&i.isVector3||r&&i&&r.isMatrix3&&i.isMatrix3?r.copy(i):this[e]=i:z("Texture.setValues(): property '".concat(e,"' does not exist."))}else z("Texture.setValues(): parameter '".concat(e,"' has value of undefined."))}}},{key:"toJSON",value:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case _:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case _:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}},{key:"needsUpdate",set:function(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}},{key:"needsPMREMUpdate",set:function(t){!0===t&&this.pmremVersion++}}]),i}(P);lt.DEFAULT_IMAGE=null,lt.DEFAULT_MAPPING=300,lt.DEFAULT_ANISOTROPY=1;var ct=function(){function t(e,i,r,n,s,a,o,u,h,l,c,f,y,p,d,m){v(this,t),t.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,i,r,n,s,a,o,u,h,l,c,f,y,p,d,m)}return g(t,[{key:"set",value:function(t,e,i,r,n,s,a,o,u,h,l,c,f,y,p,d){var v=this.elements;return v[0]=t,v[4]=e,v[8]=i,v[12]=r,v[1]=n,v[5]=s,v[9]=a,v[13]=o,v[2]=u,v[6]=h,v[10]=l,v[14]=c,v[3]=f,v[7]=y,v[11]=p,v[15]=d,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new t).fromArray(this.elements)}},{key:"copy",value:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}},{key:"copyPosition",value:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}},{key:"setFromMatrix3",value:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(t,e,i){return 0===this.determinant()?(t.set(1,0,0),e.set(0,1,0),i.set(0,0,1),this):(t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this)}},{key:"makeBasis",value:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(t){if(0===t.determinant())return this.identity();var e=this.elements,i=t.elements,r=1/ft.setFromMatrixColumn(t,0).length(),n=1/ft.setFromMatrixColumn(t,1).length(),s=1/ft.setFromMatrixColumn(t,2).length();return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[3]=0,e[4]=i[4]*n,e[5]=i[5]*n,e[6]=i[6]*n,e[7]=0,e[8]=i[8]*s,e[9]=i[9]*s,e[10]=i[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}},{key:"makeRotationFromEuler",value:function(t){var e=this.elements,i=t.x,r=t.y,n=t.z,s=Math.cos(i),a=Math.sin(i),o=Math.cos(r),u=Math.sin(r),h=Math.cos(n),l=Math.sin(n);if("XYZ"===t.order){var c=s*h,f=s*l,y=a*h,p=a*l;e[0]=o*h,e[4]=-o*l,e[8]=u,e[1]=f+y*u,e[5]=c-p*u,e[9]=-a*o,e[2]=p-c*u,e[6]=y+f*u,e[10]=s*o}else if("YXZ"===t.order){var d=o*h,v=o*l,m=u*h,g=u*l;e[0]=d+g*a,e[4]=m*a-v,e[8]=s*u,e[1]=s*l,e[5]=s*h,e[9]=-a,e[2]=v*a-m,e[6]=g+d*a,e[10]=s*o}else if("ZXY"===t.order){var _=o*h,b=o*l,k=u*h,x=u*l;e[0]=_-x*a,e[4]=-s*l,e[8]=k+b*a,e[1]=b+k*a,e[5]=s*h,e[9]=x-_*a,e[2]=-s*u,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){var M=s*h,w=s*l,A=a*h,T=a*l;e[0]=o*h,e[4]=A*u-w,e[8]=M*u+T,e[1]=o*l,e[5]=T*u+M,e[9]=w*u-A,e[2]=-u,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){var S=s*o,E=s*u,C=a*o,R=a*u;e[0]=o*h,e[4]=R-S*l,e[8]=C*l+E,e[1]=l,e[5]=s*h,e[9]=-a*h,e[2]=-u*h,e[6]=E*l+C,e[10]=S-R*l}else if("XZY"===t.order){var I=s*o,N=s*u,z=a*o,O=a*u;e[0]=o*h,e[4]=-l,e[8]=u*h,e[1]=I*l+O,e[5]=s*h,e[9]=N*l-z,e[2]=z*l-N,e[6]=a*h,e[10]=O*l+I}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(t){return this.compose(pt,t,dt)}},{key:"lookAt",value:function(t,e,i){var r=this.elements;return gt.subVectors(t,e),0===gt.lengthSq()&&(gt.z=1),gt.normalize(),vt.crossVectors(i,gt),0===vt.lengthSq()&&(1===Math.abs(i.z)?gt.x+=1e-4:gt.z+=1e-4,gt.normalize(),vt.crossVectors(i,gt)),vt.normalize(),mt.crossVectors(gt,vt),r[0]=vt.x,r[4]=mt.x,r[8]=gt.x,r[1]=vt.y,r[5]=mt.y,r[9]=gt.y,r[2]=vt.z,r[6]=mt.z,r[10]=gt.z,this}},{key:"multiply",value:function(t){return this.multiplyMatrices(this,t)}},{key:"premultiply",value:function(t){return this.multiplyMatrices(t,this)}},{key:"multiplyMatrices",value:function(t,e){var i=t.elements,r=e.elements,n=this.elements,s=i[0],a=i[4],o=i[8],u=i[12],h=i[1],l=i[5],c=i[9],f=i[13],y=i[2],p=i[6],d=i[10],v=i[14],m=i[3],g=i[7],_=i[11],b=i[15],k=r[0],x=r[4],M=r[8],w=r[12],A=r[1],T=r[5],S=r[9],E=r[13],C=r[2],R=r[6],I=r[10],N=r[14],z=r[3],O=r[7],F=r[11],P=r[15];return n[0]=s*k+a*A+o*C+u*z,n[4]=s*x+a*T+o*R+u*O,n[8]=s*M+a*S+o*I+u*F,n[12]=s*w+a*E+o*N+u*P,n[1]=h*k+l*A+c*C+f*z,n[5]=h*x+l*T+c*R+f*O,n[9]=h*M+l*S+c*I+f*F,n[13]=h*w+l*E+c*N+f*P,n[2]=y*k+p*A+d*C+v*z,n[6]=y*x+p*T+d*R+v*O,n[10]=y*M+p*S+d*I+v*F,n[14]=y*w+p*E+d*N+v*P,n[3]=m*k+g*A+_*C+b*z,n[7]=m*x+g*T+_*R+b*O,n[11]=m*M+g*S+_*I+b*F,n[15]=m*w+g*E+_*N+b*P,this}},{key:"multiplyScalar",value:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}},{key:"determinant",value:function(){var t=this.elements,e=t[0],i=t[4],r=t[8],n=t[12],s=t[1],a=t[5],o=t[9],u=t[13],h=t[2],l=t[6],c=t[10],f=t[14],y=t[3],p=t[7],d=t[11],v=t[15],m=o*f-u*c,g=a*f-u*l,_=a*c-o*l,b=s*f-u*h,k=s*c-o*h,x=s*l-a*h;return e*(p*m-d*g+v*_)-i*(y*m-d*b+v*k)+r*(y*g-p*b+v*x)-n*(y*_-p*k+d*x)}},{key:"transpose",value:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}},{key:"setPosition",value:function(t,e,i){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=i),this}},{key:"invert",value:function(){var t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],a=t[5],o=t[6],u=t[7],h=t[8],l=t[9],c=t[10],f=t[11],y=t[12],p=t[13],d=t[14],v=t[15],m=l*d*u-p*c*u+p*o*f-a*d*f-l*o*v+a*c*v,g=y*c*u-h*d*u-y*o*f+s*d*f+h*o*v-s*c*v,_=h*p*u-y*l*u+y*a*f-s*p*f-h*a*v+s*l*v,b=y*l*o-h*p*o-y*a*c+s*p*c+h*a*d-s*l*d,k=e*m+i*g+r*_+n*b;if(0===k)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var x=1/k;return t[0]=m*x,t[1]=(p*c*n-l*d*n-p*r*f+i*d*f+l*r*v-i*c*v)*x,t[2]=(a*d*n-p*o*n+p*r*u-i*d*u-a*r*v+i*o*v)*x,t[3]=(l*o*n-a*c*n-l*r*u+i*c*u+a*r*f-i*o*f)*x,t[4]=g*x,t[5]=(h*d*n-y*c*n+y*r*f-e*d*f-h*r*v+e*c*v)*x,t[6]=(y*o*n-s*d*n-y*r*u+e*d*u+s*r*v-e*o*v)*x,t[7]=(s*c*n-h*o*n+h*r*u-e*c*u-s*r*f+e*o*f)*x,t[8]=_*x,t[9]=(y*l*n-h*p*n-y*i*f+e*p*f+h*i*v-e*l*v)*x,t[10]=(s*p*n-y*a*n+y*i*u-e*p*u-s*i*v+e*a*v)*x,t[11]=(h*a*n-s*l*n-h*i*u+e*l*u+s*i*f-e*a*f)*x,t[12]=b*x,t[13]=(h*p*r-y*l*r+y*i*c-e*p*c-h*i*d+e*l*d)*x,t[14]=(y*a*r-s*p*r-y*i*o+e*p*o+s*i*d-e*a*d)*x,t[15]=(s*l*r-h*a*r+h*i*o-e*l*o-s*i*c+e*a*c)*x,this}},{key:"scale",value:function(t){var e=this.elements,i=t.x,r=t.y,n=t.z;return e[0]*=i,e[4]*=r,e[8]*=n,e[1]*=i,e[5]*=r,e[9]*=n,e[2]*=i,e[6]*=r,e[10]*=n,e[3]*=i,e[7]*=r,e[11]*=n,this}},{key:"getMaxScaleOnAxis",value:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,r))}},{key:"makeTranslation",value:function(t,e,i){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}},{key:"makeRotationX",value:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}},{key:"makeRotationY",value:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=1-i,s=t.x,a=t.y,o=t.z,u=n*s,h=n*a;return this.set(u*s+i,u*a-r*o,u*o+r*a,0,u*a+r*o,h*a+i,h*o-r*s,0,u*o-r*a,h*o+r*s,n*o*o+i,0,0,0,0,1),this}},{key:"makeScale",value:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}},{key:"makeShear",value:function(t,e,i,r,n,s){return this.set(1,i,n,0,t,1,s,0,e,r,1,0,0,0,0,1),this}},{key:"compose",value:function(t,e,i){var r=this.elements,n=e._x,s=e._y,a=e._z,o=e._w,u=n+n,h=s+s,l=a+a,c=n*u,f=n*h,y=n*l,p=s*h,d=s*l,v=a*l,m=o*u,g=o*h,_=o*l,b=i.x,k=i.y,x=i.z;return r[0]=(1-(p+v))*b,r[1]=(f+_)*b,r[2]=(y-g)*b,r[3]=0,r[4]=(f-_)*k,r[5]=(1-(c+v))*k,r[6]=(d+m)*k,r[7]=0,r[8]=(y+g)*x,r[9]=(d-m)*x,r[10]=(1-(c+p))*x,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}},{key:"decompose",value:function(t,e,i){var r=this.elements;if(t.x=r[12],t.y=r[13],t.z=r[14],0===this.determinant())return i.set(1,1,1),e.identity(),this;var n=ft.set(r[0],r[1],r[2]).length(),s=ft.set(r[4],r[5],r[6]).length(),a=ft.set(r[8],r[9],r[10]).length();this.determinant()<0&&(n=-n),yt.copy(this);var o=1/n,u=1/s,h=1/a;return yt.elements[0]*=o,yt.elements[1]*=o,yt.elements[2]*=o,yt.elements[4]*=u,yt.elements[5]*=u,yt.elements[6]*=u,yt.elements[8]*=h,yt.elements[9]*=h,yt.elements[10]*=h,e.setFromRotationMatrix(yt),i.x=n,i.y=s,i.z=a,this}},{key:"makePerspective",value:function(t,e,i,r,n,s){var a,o,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:C,h=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=this.elements,c=2*n/(e-t),f=2*n/(i-r),y=(e+t)/(e-t),p=(i+r)/(i-r);if(h)a=n/(s-n),o=s*n/(s-n);else if(u===C)a=-(s+n)/(s-n),o=-2*s*n/(s-n);else{if(u!==R)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);a=-s/(s-n),o=-s*n/(s-n)}return l[0]=c,l[4]=0,l[8]=y,l[12]=0,l[1]=0,l[5]=f,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=a,l[14]=o,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}},{key:"makeOrthographic",value:function(t,e,i,r,n,s){var a,o,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:C,h=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=this.elements,c=2/(e-t),f=2/(i-r),y=-(e+t)/(e-t),p=-(i+r)/(i-r);if(h)a=1/(s-n),o=s/(s-n);else if(u===C)a=-2/(s-n),o=-(s+n)/(s-n);else{if(u!==R)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);a=-1/(s-n),o=-n/(s-n)}return l[0]=c,l[4]=0,l[8]=0,l[12]=y,l[1]=0,l[5]=f,l[9]=0,l[13]=p,l[2]=0,l[6]=0,l[10]=a,l[14]=o,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}},{key:"equals",value:function(t){for(var e=this.elements,i=t.elements,r=0;r<16;r++)if(e[r]!==i[r])return!1;return!0}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0;i<16;i++)this.elements[i]=t[i+e];return this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}]),t}(),ft=new H,yt=new ct,pt=new H(0,0,0),dt=new H(1,1,1),vt=new H,mt=new H,gt=new H,_t=new ct,bt=new Y,kt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.DEFAULT_ORDER;v(this,t),this.isEuler=!0,this._x=e,this._y=i,this._z=r,this._order=n}return g(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}},{key:"set",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=t,this._y=e,this._z=i,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.elements,n=r[0],s=r[4],a=r[8],o=r[1],u=r[5],h=r[9],l=r[2],c=r[6],f=r[10];switch(e){case"XYZ":this._y=Math.asin(U(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,f),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(c,u),this._z=0);break;case"YXZ":this._x=Math.asin(-U(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(o,u)):(this._y=Math.atan2(-l,n),this._z=0);break;case"ZXY":this._x=Math.asin(U(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(-l,f),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-U(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(c,f),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(U(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-l,n)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-U(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(c,u),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-h,f),this._y=0);break;default:z("Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===i&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(t,e,i){return _t.makeRotationFromQuaternion(t),this.setFromRotationMatrix(_t,e,i)}},{key:"setFromVector3",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(t.x,t.y,t.z,e)}},{key:"reorder",value:function(t){return bt.setFromEuler(this),this.setFromQuaternion(bt,t)}},{key:"equals",value:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}},{key:"fromArray",value:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}},{key:"_onChange",value:function(t){return this._onChangeCallback=t,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._x;case 2:return t.next=4,this._y;case 4:return t.next=6,this._z;case 6:return t.next=8,this._order;case 8:case"end":return t.stop()}}),t,this)}))}]),t}();kt.DEFAULT_ORDER="XYZ";var xt=function(){function t(){v(this,t),this.mask=1}return g(t,[{key:"set",value:function(t){this.mask=(1<<t|0)>>>0}},{key:"enable",value:function(t){this.mask|=1<<t|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(t){this.mask^=1<<t|0}},{key:"disable",value:function(t){this.mask&=~(1<<t|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(t){return 0!=(this.mask&t.mask)}},{key:"isEnabled",value:function(t){return 0!=(this.mask&(1<<t|0))}}]),t}(),Mt=0,wt=new H,At=new Y,Tt=new ct,St=new H,Et=new H,Ct=new H,Rt=new Y,It=new H(1,0,0),Nt=new H(0,1,0),zt=new H(0,0,1),Ot={type:"added"},Ft={type:"removed"},Pt={type:"childadded",child:null},Vt={type:"childremoved",child:null},Dt=function(t){u(i,t);var e=l(i);function i(){var t;v(this,i),(t=e.call(this)).isObject3D=!0,Object.defineProperty(f(t),"id",{value:Mt++}),t.uuid=D(),t.name="",t.type="Object3D",t.parent=null,t.children=[],t.up=i.DEFAULT_UP.clone();var r=new H,n=new kt,s=new Y,a=new H(1,1,1);return n._onChange((function(){s.setFromEuler(n,!1)})),s._onChange((function(){n.setFromQuaternion(s,void 0,!1)})),Object.defineProperties(f(t),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new ct},normalMatrix:{value:new Z}}),t.matrix=new ct,t.matrixWorld=new ct,t.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,t.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,t.matrixWorldNeedsUpdate=!1,t.layers=new xt,t.visible=!0,t.castShadow=!1,t.receiveShadow=!1,t.frustumCulled=!0,t.renderOrder=0,t.animations=[],t.customDepthMaterial=void 0,t.customDistanceMaterial=void 0,t.userData={},t}return g(i,[{key:"onBeforeShadow",value:function(){}},{key:"onAfterShadow",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(t){return this.quaternion.premultiply(t),this}},{key:"setRotationFromAxisAngle",value:function(t,e){this.quaternion.setFromAxisAngle(t,e)}},{key:"setRotationFromEuler",value:function(t){this.quaternion.setFromEuler(t,!0)}},{key:"setRotationFromMatrix",value:function(t){this.quaternion.setFromRotationMatrix(t)}},{key:"setRotationFromQuaternion",value:function(t){this.quaternion.copy(t)}},{key:"rotateOnAxis",value:function(t,e){return At.setFromAxisAngle(t,e),this.quaternion.multiply(At),this}},{key:"rotateOnWorldAxis",value:function(t,e){return At.setFromAxisAngle(t,e),this.quaternion.premultiply(At),this}},{key:"rotateX",value:function(t){return this.rotateOnAxis(It,t)}},{key:"rotateY",value:function(t){return this.rotateOnAxis(Nt,t)}},{key:"rotateZ",value:function(t){return this.rotateOnAxis(zt,t)}},{key:"translateOnAxis",value:function(t,e){return wt.copy(t).applyQuaternion(this.quaternion),this.position.add(wt.multiplyScalar(e)),this}},{key:"translateX",value:function(t){return this.translateOnAxis(It,t)}},{key:"translateY",value:function(t){return this.translateOnAxis(Nt,t)}},{key:"translateZ",value:function(t){return this.translateOnAxis(zt,t)}},{key:"localToWorld",value:function(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Tt.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(t,e,i){t.isVector3?St.copy(t):St.set(t,e,i);var r=this.parent;this.updateWorldMatrix(!0,!1),Et.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tt.lookAt(Et,St,this.up):Tt.lookAt(St,Et,this.up),this.quaternion.setFromRotationMatrix(Tt),r&&(Tt.extractRotation(r.matrixWorld),At.setFromRotationMatrix(Tt),this.quaternion.premultiply(At.invert()))}},{key:"add",value:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(O("Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Ot),Pt.child=t,this.dispatchEvent(Pt),Pt.child=null):O("Object3D.add: object not an instance of THREE.Object3D.",t),this)}},{key:"remove",value:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Ft),Vt.child=t,this.dispatchEvent(Vt),Vt.child=null),this}},{key:"removeFromParent",value:function(){var t=this.parent;return null!==t&&t.remove(this),this}},{key:"clear",value:function(){return this.remove.apply(this,a(this.children))}},{key:"attach",value:function(t){return this.updateWorldMatrix(!0,!1),Tt.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Tt.multiply(t.parent.matrixWorld)),t.applyMatrix4(Tt),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Ot),Pt.child=t,this.dispatchEvent(Pt),Pt.child=null,this}},{key:"getObjectById",value:function(t){return this.getObjectByProperty("id",t)}},{key:"getObjectByName",value:function(t){return this.getObjectByProperty("name",t)}},{key:"getObjectByProperty",value:function(t,e){if(this[t]===e)return this;for(var i=0,r=this.children.length;i<r;i++){var n=this.children[i].getObjectByProperty(t,e);if(void 0!==n)return n}}},{key:"getObjectsByProperty",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[t]===e&&i.push(this);for(var r=this.children,n=0,s=r.length;n<s;n++)r[n].getObjectsByProperty(t,e,i);return i}},{key:"getWorldPosition",value:function(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Et,t,Ct),t}},{key:"getWorldScale",value:function(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Et,Rt,t),t}},{key:"getWorldDirection",value:function(t){this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(t){t(this);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].traverse(t)}},{key:"traverseVisible",value:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].traverseVisible(t)}}},{key:"traverseAncestors",value:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].updateMatrixWorld(t)}},{key:"updateWorldMatrix",value:function(t,e){var i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===e)for(var r=this.children,n=0,s=r.length;n<s;n++)r[n].updateWorldMatrix(!1,!0)}},{key:"toJSON",value:function(t){var e=void 0===t||"string"==typeof t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});var r={};function n(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map((function(t){return s(s({},t),{},{boundingBox:t.boundingBox?t.boundingBox.toJSON():void 0,boundingSphere:t.boundingSphere?t.boundingSphere.toJSON():void 0})})),r.instanceInfo=this._instanceInfo.map((function(t){return s({},t)})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(t),r.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(r.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(r.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=n(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var u=0,h=o.length;u<h;u++){var l=o[u];n(t.shapes,l)}else n(t.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(n(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],f=0,y=this.material.length;f<y;f++)c.push(n(t.materials,this.material[f]));r.material=c}else r.material=n(t.materials,this.material);if(this.children.length>0){r.children=[];for(var p=0;p<this.children.length;p++)r.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(var d=0;d<this.animations.length;d++){var v=this.animations[d];r.animations.push(n(t.animations,v))}}if(e){var m=A(t.geometries),g=A(t.materials),_=A(t.textures),b=A(t.images),k=A(t.shapes),x=A(t.skeletons),M=A(t.animations),w=A(t.nodes);m.length>0&&(i.geometries=m),g.length>0&&(i.materials=g),_.length>0&&(i.textures=_),b.length>0&&(i.images=b),k.length>0&&(i.shapes=k),x.length>0&&(i.skeletons=x),M.length>0&&(i.animations=M),w.length>0&&(i.nodes=w)}return i.object=r,i;function A(t){var e=[];for(var i in t){var r=t[i];delete r.metadata,e.push(r)}return e}}},{key:"clone",value:function(t){return(new this.constructor).copy(this,t)}},{key:"copy",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var i=0;i<t.children.length;i++){var r=t.children[i];this.add(r.clone())}return this}}]),i}(P);Dt.DEFAULT_UP=new H(0,1,0),Dt.DEFAULT_MATRIX_AUTO_UPDATE=!0,Dt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Ut={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Lt={h:0,s:0,l:0},Wt={h:0,s:0,l:0};function Bt(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}var jt=function(){function t(e,i,r){return v(this,t),this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,r)}return g(t,[{key:"set",value:function(t,e,i){if(void 0===e&&void 0===i){var r=t;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(t,e,i);return this}},{key:"setScalar",value:function(t){return this.r=t,this.g=t,this.b=t,this}},{key:"setHex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,et.colorSpaceToWorking(this,e),this}},{key:"setRGB",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:et.workingColorSpace;return this.r=t,this.g=e,this.b=i,et.colorSpaceToWorking(this,r),this}},{key:"setHSL",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:et.workingColorSpace;if(t=L(t,1),e=U(e,0,1),i=U(i,0,1),0===e)this.r=this.g=this.b=i;else{var n=i<=.5?i*(1+e):i+e-i*e,s=2*i-n;this.r=Bt(s,n,t+1/3),this.g=Bt(s,n,t),this.b=Bt(s,n,t-1/3)}return et.colorSpaceToWorking(this,r),this}},{key:"setStyle",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;function r(e){void 0!==e&&parseFloat(e)<1&&z("Color: Alpha component of "+t+" will be ignored.")}if(e=/^(\w+)\(([^\)]*)\)/.exec(t)){var n,s=e[1],a=e[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(n[4]),this.setRGB(Math.min(255,parseInt(n[1],10))/255,Math.min(255,parseInt(n[2],10))/255,Math.min(255,parseInt(n[3],10))/255,i);if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(n[4]),this.setRGB(Math.min(100,parseInt(n[1],10))/100,Math.min(100,parseInt(n[2],10))/100,Math.min(100,parseInt(n[3],10))/100,i);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(n[4]),this.setHSL(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,i);break;default:z("Color: Unknown color model "+t)}}else if(e=/^\#([A-Fa-f\d]+)$/.exec(t)){var o=e[1],u=o.length;if(3===u)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,i);if(6===u)return this.setHex(parseInt(o,16),i);z("Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,i);return this}},{key:"setColorName",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M,i=Ut[t.toLowerCase()];return void 0!==i?this.setHex(i,e):z("Color: Unknown color "+t),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}},{key:"copySRGBToLinear",value:function(t){return this.r=it(t.r),this.g=it(t.g),this.b=it(t.b),this}},{key:"copyLinearToSRGB",value:function(t){return this.r=rt(t.r),this.g=rt(t.g),this.b=rt(t.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;return et.workingToColorSpace(Xt.copy(this),t),65536*Math.round(U(255*Xt.r,0,255))+256*Math.round(U(255*Xt.g,0,255))+Math.round(U(255*Xt.b,0,255))}},{key:"getHexString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;return("000000"+this.getHex(t).toString(16)).slice(-6)}},{key:"getHSL",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:et.workingColorSpace;et.workingToColorSpace(Xt.copy(this),e);var i,r,n=Xt.r,s=Xt.g,a=Xt.b,o=Math.max(n,s,a),u=Math.min(n,s,a),h=(u+o)/2;if(u===o)i=0,r=0;else{var l=o-u;switch(r=h<=.5?l/(o+u):l/(2-o-u),o){case n:i=(s-a)/l+(s<a?6:0);break;case s:i=(a-n)/l+2;break;case a:i=(n-s)/l+4}i/=6}return t.h=i,t.s=r,t.l=h,t}},{key:"getRGB",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:et.workingColorSpace;return et.workingToColorSpace(Xt.copy(this),e),t.r=Xt.r,t.g=Xt.g,t.b=Xt.b,t}},{key:"getStyle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;et.workingToColorSpace(Xt.copy(this),t);var e=Xt.r,i=Xt.g,r=Xt.b;return t!==M?"color(".concat(t," ").concat(e.toFixed(3)," ").concat(i.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*e),",").concat(Math.round(255*i),",").concat(Math.round(255*r),")")}},{key:"offsetHSL",value:function(t,e,i){return this.getHSL(Lt),this.setHSL(Lt.h+t,Lt.s+e,Lt.l+i)}},{key:"add",value:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}},{key:"addColors",value:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}},{key:"addScalar",value:function(t){return this.r+=t,this.g+=t,this.b+=t,this}},{key:"sub",value:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}},{key:"multiply",value:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}},{key:"multiplyScalar",value:function(t){return this.r*=t,this.g*=t,this.b*=t,this}},{key:"lerp",value:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}},{key:"lerpColors",value:function(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}},{key:"lerpHSL",value:function(t,e){this.getHSL(Lt),t.getHSL(Wt);var i=W(Lt.h,Wt.h,e),r=W(Lt.s,Wt.s,e),n=W(Lt.l,Wt.l,e);return this.setHSL(i,r,n),this}},{key:"setFromVector3",value:function(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}},{key:"applyMatrix3",value:function(t){var e=this.r,i=this.g,r=this.b,n=t.elements;return this.r=n[0]*e+n[3]*i+n[6]*r,this.g=n[1]*e+n[4]*i+n[7]*r,this.b=n[2]*e+n[5]*i+n[8]*r,this}},{key:"equals",value:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}},{key:"fromBufferAttribute",value:function(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}},{key:"toJSON",value:function(){return this.getHex()}},{key:Symbol.iterator,value:regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.r;case 2:return t.next=4,this.g;case 4:return t.next=6,this.b;case 6:case"end":return t.stop()}}),t,this)}))}]),t}(),Xt=new jt;jt.NAMES=Ut;var Yt=new H,Ht=new X,qt=0,Gt=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(v(this,t),Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:qt++}),this.name="",this.array=e,this.itemSize=i,this.count=void 0!==e?e.length/i:0,this.normalized=r,this.usage=S,this.updateRanges=[],this.gpuType=1015,this.version=0}return g(t,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(t){!0===t&&this.version++}},{key:"setUsage",value:function(t){return this.usage=t,this}},{key:"addUpdateRange",value:function(t,e){this.updateRanges.push({start:t,count:e})}},{key:"clearUpdateRanges",value:function(){this.updateRanges.length=0}},{key:"copy",value:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}},{key:"copyAt",value:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var r=0,n=this.itemSize;r<n;r++)this.array[t+r]=e.array[i+r];return this}},{key:"copyArray",value:function(t){return this.array.set(t),this}},{key:"applyMatrix3",value:function(t){if(2===this.itemSize)for(var e=0,i=this.count;e<i;e++)Ht.fromBufferAttribute(this,e),Ht.applyMatrix3(t),this.setXY(e,Ht.x,Ht.y);else if(3===this.itemSize)for(var r=0,n=this.count;r<n;r++)Yt.fromBufferAttribute(this,r),Yt.applyMatrix3(t),this.setXYZ(r,Yt.x,Yt.y,Yt.z);return this}},{key:"applyMatrix4",value:function(t){for(var e=0,i=this.count;e<i;e++)Yt.fromBufferAttribute(this,e),Yt.applyMatrix4(t),this.setXYZ(e,Yt.x,Yt.y,Yt.z);return this}},{key:"applyNormalMatrix",value:function(t){for(var e=0,i=this.count;e<i;e++)Yt.fromBufferAttribute(this,e),Yt.applyNormalMatrix(t),this.setXYZ(e,Yt.x,Yt.y,Yt.z);return this}},{key:"transformDirection",value:function(t){for(var e=0,i=this.count;e<i;e++)Yt.fromBufferAttribute(this,e),Yt.transformDirection(t),this.setXYZ(e,Yt.x,Yt.y,Yt.z);return this}},{key:"set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this}},{key:"getComponent",value:function(t,e){var i=this.array[t*this.itemSize+e];return this.normalized&&(i=B(i,this.array)),i}},{key:"setComponent",value:function(t,e,i){return this.normalized&&(i=j(i,this.array)),this.array[t*this.itemSize+e]=i,this}},{key:"getX",value:function(t){var e=this.array[t*this.itemSize];return this.normalized&&(e=B(e,this.array)),e}},{key:"setX",value:function(t,e){return this.normalized&&(e=j(e,this.array)),this.array[t*this.itemSize]=e,this}},{key:"getY",value:function(t){var e=this.array[t*this.itemSize+1];return this.normalized&&(e=B(e,this.array)),e}},{key:"setY",value:function(t,e){return this.normalized&&(e=j(e,this.array)),this.array[t*this.itemSize+1]=e,this}},{key:"getZ",value:function(t){var e=this.array[t*this.itemSize+2];return this.normalized&&(e=B(e,this.array)),e}},{key:"setZ",value:function(t,e){return this.normalized&&(e=j(e,this.array)),this.array[t*this.itemSize+2]=e,this}},{key:"getW",value:function(t){var e=this.array[t*this.itemSize+3];return this.normalized&&(e=B(e,this.array)),e}},{key:"setW",value:function(t,e){return this.normalized&&(e=j(e,this.array)),this.array[t*this.itemSize+3]=e,this}},{key:"setXY",value:function(t,e,i){return t*=this.itemSize,this.normalized&&(e=j(e,this.array),i=j(i,this.array)),this.array[t+0]=e,this.array[t+1]=i,this}},{key:"setXYZ",value:function(t,e,i,r){return t*=this.itemSize,this.normalized&&(e=j(e,this.array),i=j(i,this.array),r=j(r,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this}},{key:"setXYZW",value:function(t,e,i,r,n){return t*=this.itemSize,this.normalized&&(e=j(e,this.array),i=j(i,this.array),r=j(r,this.array),n=j(n,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this.array[t+3]=n,this}},{key:"onUpload",value:function(t){return this.onUploadCallback=t,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==S&&(t.usage=this.usage),t}}]),t}();function Zt(t,e){return t&&t.constructor!==e?"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t):t}var Kt=function(){function t(e,i,r,n){v(this,t),this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new i.constructor(r),this.sampleValues=i,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return g(t,[{key:"evaluate",value:function(t){var e=this.parameterPositions,i=this._cachedIndex,r=e[i],n=e[i-1];t:{e:{var s;i:{r:if(!(t<r)){for(var a=i+2;;){if(void 0===r){if(t<n)break r;return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(n=r,t<(r=e[++i]))break e}s=e.length;break i}if(t>=n)break t;var o=e[1];t<o&&(i=2,n=o);for(var u=i-2;;){if(void 0===n)return this._cachedIndex=0,this.copySampleValue_(0);if(i===u)break;if(r=n,t>=(n=e[--i-1]))break e}s=i,i=0}for(;i<s;){var h=i+s>>>1;t<e[h]?s=h:i=h+1}if(r=e[i],void 0===(n=e[i-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,n,r)}return this.interpolate_(i,n,t,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(t){for(var e=this.resultBuffer,i=this.sampleValues,r=this.valueSize,n=t*r,s=0;s!==r;++s)e[s]=i[n+s];return e}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),t}(),Jt=function(t){u(i,t);var e=l(i);function i(t,r,n,s){var a;return v(this,i),(a=e.call(this,t,r,n,s))._weightPrev=-0,a._offsetPrev=-0,a._weightNext=-0,a._offsetNext=-0,a.DefaultSettings_={endingStart:2400,endingEnd:2400},a}return g(i,[{key:"intervalChanged_",value:function(t,e,i){var r=this.parameterPositions,n=t-2,s=t+1,a=r[n],o=r[s];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:n=t,a=2*e-i;break;case 2402:a=e+r[n=r.length-2]-r[n+1];break;default:n=t,a=i}if(void 0===o)switch(this.getSettings_().endingEnd){case 2401:s=t,o=2*i-e;break;case 2402:s=1,o=i+r[1]-r[0];break;default:s=t-1,o=e}var u=.5*(i-e),h=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(o-i),this._offsetPrev=n*h,this._offsetNext=s*h}},{key:"interpolate_",value:function(t,e,i,r){for(var n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,u=o-a,h=this._offsetPrev,l=this._offsetNext,c=this._weightPrev,f=this._weightNext,y=(i-e)/(r-e),p=y*y,d=p*y,v=-c*d+2*c*p-c*y,m=(1+c)*d+(-1.5-2*c)*p+(-.5+c)*y+1,g=(-1-f)*d+(1.5+f)*p+.5*y,_=f*d-f*p,b=0;b!==a;++b)n[b]=v*s[h+b]+m*s[u+b]+g*s[o+b]+_*s[l+b];return n}}]),i}(Kt),Qt=function(t){u(i,t);var e=l(i);function i(t,r,n,s){return v(this,i),e.call(this,t,r,n,s)}return g(i,[{key:"interpolate_",value:function(t,e,i,r){for(var n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,u=o-a,h=(i-e)/(r-e),l=1-h,c=0;c!==a;++c)n[c]=s[u+c]*l+s[o+c]*h;return n}}]),i}(Kt),$t=function(t){u(i,t);var e=l(i);function i(t,r,n,s){return v(this,i),e.call(this,t,r,n,s)}return g(i,[{key:"interpolate_",value:function(t){return this.copySampleValue_(t-1)}}]),i}(Kt),te=function(){function t(e,i,r,n){if(v(this,t),void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===i||0===i.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Zt(i,this.TimeBufferType),this.values=Zt(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}return g(t,[{key:"InterpolantFactoryMethodDiscrete",value:function(t){return new $t(this.times,this.values,this.getValueSize(),t)}},{key:"InterpolantFactoryMethodLinear",value:function(t){return new Qt(this.times,this.values,this.getValueSize(),t)}},{key:"InterpolantFactoryMethodSmooth",value:function(t){return new Jt(this.times,this.values,this.getValueSize(),t)}},{key:"setInterpolation",value:function(t){var e;switch(t){case b:e=this.InterpolantFactoryMethodDiscrete;break;case k:e=this.InterpolantFactoryMethodLinear;break;case x:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return z("KeyframeTrack:",i),this}return this.createInterpolant=e,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return b;case this.InterpolantFactoryMethodLinear:return k;case this.InterpolantFactoryMethodSmooth:return x}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(t){if(0!==t)for(var e=this.times,i=0,r=e.length;i!==r;++i)e[i]+=t;return this}},{key:"scale",value:function(t){if(1!==t)for(var e=this.times,i=0,r=e.length;i!==r;++i)e[i]*=t;return this}},{key:"trim",value:function(t,e){for(var i=this.times,r=i.length,n=0,s=r-1;n!==r&&i[n]<t;)++n;for(;-1!==s&&i[s]>e;)--s;if(++s,0!==n||s!==r){n>=s&&(n=(s=Math.max(s,1))-1);var a=this.getValueSize();this.times=i.slice(n,s),this.values=this.values.slice(n*a,s*a)}return this}},{key:"validate",value:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(O("KeyframeTrack: Invalid value size in track.",this),t=!1);var i,r=this.times,n=this.values,s=r.length;0===s&&(O("KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==s;o++){var u=r[o];if("number"==typeof u&&isNaN(u)){O("KeyframeTrack: Time is not a valid number.",this,o,u),t=!1;break}if(null!==a&&a>u){O("KeyframeTrack: Out of order keys.",this,o,u,a),t=!1;break}a=u}if(void 0!==n&&(i=n,ArrayBuffer.isView(i)&&!(i instanceof DataView)))for(var h=0,l=n.length;h!==l;++h){var c=n[h];if(isNaN(c)){O("KeyframeTrack: Value is not a valid number.",this,h,c),t=!1;break}}return t}},{key:"optimize",value:function(){for(var t=this.times.slice(),e=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===x,n=t.length-1,s=1,a=1;a<n;++a){var o=!1,u=t[a];if(u!==t[a+1]&&(1!==a||u!==t[0]))if(r)o=!0;else for(var h=a*i,l=h-i,c=h+i,f=0;f!==i;++f){var y=e[h+f];if(y!==e[l+f]||y!==e[c+f]){o=!0;break}}if(o){if(a!==s){t[s]=t[a];for(var p=a*i,d=s*i,v=0;v!==i;++v)e[d+v]=e[p+v]}++s}}if(n>0){t[s]=t[n];for(var m=n*i,g=s*i,_=0;_!==i;++_)e[g+_]=e[m+_];++s}return s!==t.length?(this.times=t.slice(0,s),this.values=e.slice(0,s*i)):(this.times=t,this.values=e),this}},{key:"clone",value:function(){var t=this.times.slice(),e=this.values.slice(),i=new(0,this.constructor)(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}],[{key:"toJSON",value:function(t){var e,i=t.constructor;if(i.toJSON!==this.toJSON)e=i.toJSON(t);else{e={name:t.name,times:Zt(t.times,Array),values:Zt(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}]),t}();te.prototype.ValueTypeName="",te.prototype.TimeBufferType=Float32Array,te.prototype.ValueBufferType=Float32Array,te.prototype.DefaultInterpolation=k;var ee=function(t){u(i,t);var e=l(i);function i(t,r,n){return v(this,i),e.call(this,t,r,n)}return i}(te);ee.prototype.ValueTypeName="bool",ee.prototype.ValueBufferType=Array,ee.prototype.DefaultInterpolation=b,ee.prototype.InterpolantFactoryMethodLinear=void 0,ee.prototype.InterpolantFactoryMethodSmooth=void 0,function(t){u(i,t);var e=l(i);function i(t,r,n,s){return v(this,i),e.call(this,t,r,n,s)}return i}(te).prototype.ValueTypeName="color",function(t){u(i,t);var e=l(i);function i(t,r,n,s){return v(this,i),e.call(this,t,r,n,s)}return i}(te).prototype.ValueTypeName="number";var ie=function(t){u(i,t);var e=l(i);function i(t,r,n,s){return v(this,i),e.call(this,t,r,n,s)}return g(i,[{key:"interpolate_",value:function(t,e,i,r){for(var n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(i-e)/(r-e),u=t*a,h=u+a;u!==h;u+=4)Y.slerpFlat(n,0,s,u-a,s,u,o);return n}}]),i}(Kt),re=function(t){u(i,t);var e=l(i);function i(t,r,n,s){return v(this,i),e.call(this,t,r,n,s)}return g(i,[{key:"InterpolantFactoryMethodLinear",value:function(t){return new ie(this.times,this.values,this.getValueSize(),t)}}]),i}(te);re.prototype.ValueTypeName="quaternion",re.prototype.InterpolantFactoryMethodSmooth=void 0;var ne=function(t){u(i,t);var e=l(i);function i(t,r,n){return v(this,i),e.call(this,t,r,n)}return i}(te);ne.prototype.ValueTypeName="string",ne.prototype.ValueBufferType=Array,ne.prototype.DefaultInterpolation=b,ne.prototype.InterpolantFactoryMethodLinear=void 0,ne.prototype.InterpolantFactoryMethodSmooth=void 0,function(t){u(i,t);var e=l(i);function i(t,r,n,s){return v(this,i),e.call(this,t,r,n,s)}return i}(te).prototype.ValueTypeName="vector";var se=new(function(){function t(e,i,r){v(this,t);var n=this,s=!1,a=0,o=0,u=void 0,h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=r,this._abortController=null,this.itemStart=function(t){o++,!1===s&&void 0!==n.onStart&&n.onStart(t,a,o),s=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return u?u(t):t},this.setURLModifier=function(t){return u=t,this},this.addHandler=function(t,e){return h.push(t,e),this},this.removeHandler=function(t){var e=h.indexOf(t);return-1!==e&&h.splice(e,2),this},this.getHandler=function(t){for(var e=0,i=h.length;e<i;e+=2){var r=h[e],n=h[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return n}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}return g(t,[{key:"abortController",get:function(){return this._abortController||(this._abortController=new AbortController),this._abortController}}]),t}());(function(){function t(e){v(this,t),this.manager=void 0!==e?e:se,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return g(t,[{key:"load",value:function(){}},{key:"loadAsync",value:function(t,e){var i=this;return new Promise((function(r,n){i.load(t,r,e,n)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(t){return this.crossOrigin=t,this}},{key:"setWithCredentials",value:function(t){return this.withCredentials=t,this}},{key:"setPath",value:function(t){return this.path=t,this}},{key:"setResourcePath",value:function(t){return this.resourcePath=t,this}},{key:"setRequestHeader",value:function(t){return this.requestHeader=t,this}},{key:"abort",value:function(){return this}}]),t}()).DEFAULT_MATERIAL_NAME="__DEFAULT",Error,new WeakMap,new WeakMap;var ae=new RegExp("[\\[\\]\\.:\\/]","g"),oe="[^\\[\\]\\.:\\/]",ue="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",he=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",oe)+/(WCOD+)?/.source.replace("WCOD",ue)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",oe)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",oe)+"$"),le=["material","materials","bones","map"],ce=function(){function t(e,i,r){v(this,t);var n=r||fe.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,n)}return g(t,[{key:"getValue",value:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,r=this._bindings[i];void 0!==r&&r.getValue(t,e)}},{key:"setValue",value:function(t,e){for(var i=this._bindings,r=this._targetGroup.nCachedObjects_,n=i.length;r!==n;++r)i[r].setValue(t,e)}},{key:"bind",value:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}},{key:"unbind",value:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}]),t}(),fe=function(){function t(e,i,r){v(this,t),this.path=i,this.parsedPath=r||t.parseTrackName(i),this.node=t.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return g(t,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(t,e){t[e]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)t[e++]=i[r]}},{key:"_getValue_arrayElement",value:function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(t,e){this.resolvedProperty.toArray(t,e)}},{key:"_setValue_direct",value:function(t,e){this.targetObject[this.propertyName]=t[e]}},{key:"_setValue_direct_setNeedsUpdate",value:function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++]}},{key:"_setValue_array_setNeedsUpdate",value:function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(t,e){this.resolvedProperty.fromArray(t,e)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(t,e){this.bind(),this.getValue(t,e)}},{key:"_setValue_unbound",value:function(t,e){this.bind(),this.setValue(t,e)}},{key:"bind",value:function(){var e=this.node,i=this.parsedPath,r=i.objectName,n=i.propertyName,s=i.propertyIndex;if(e||(e=t.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(r){var a=i.objectIndex;switch(r){case"materials":if(!e.material)return void O("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void O("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void O("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void O("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void O("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[r])return void O("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==a){if(void 0===e[a])return void O("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var u=e[n];if(void 0!==u){var h=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?h=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(h=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==s){if("morphTargetInfluences"===n){if(!e.geometry)return void O("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void O("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[s]&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=s}else void 0!==u.fromArray&&void 0!==u.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(l=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][h]}else O("PropertyBinding: Trying to update property for track: "+i.nodeName+"."+n+" but it wasn't found.",e)}else z("PropertyBinding: No target node found for track: "+this.path+".")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(e,i,r){return e&&e.isAnimationObjectGroup?new t.Composite(e,i,r):new t(e,i,r)}},{key:"sanitizeNodeName",value:function(t){return t.replace(/\s/g,"_").replace(ae,"")}},{key:"parseTrackName",value:function(t){var e=he.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var n=i.nodeName.substring(r+1);-1!==le.indexOf(n)&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=n)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}},{key:"findNode",value:function(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){var r=function t(i){for(var r=0;r<i.length;r++){var n=i[r];if(n.name===e||n.uuid===e)return n;var s=t(n.children);if(s)return s}return null}(t.children);if(r)return r}return null}}]),t}();fe.Composite=ce,fe.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},fe.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},fe.prototype.GetterByBindingType=[fe.prototype._getValue_direct,fe.prototype._getValue_array,fe.prototype._getValue_arrayElement,fe.prototype._getValue_toArray],fe.prototype.SetterByBindingTypeAndVersioning=[[fe.prototype._setValue_direct,fe.prototype._setValue_direct_setNeedsUpdate,fe.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fe.prototype._setValue_array,fe.prototype._setValue_array_setNeedsUpdate,fe.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fe.prototype._setValue_arrayElement,fe.prototype._setValue_arrayElement_setNeedsUpdate,fe.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fe.prototype._setValue_fromArray,fe.prototype._setValue_fromArray_setNeedsUpdate,fe.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"182"}})),"undefined"!=typeof window&&(window.__THREE__?z("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="182"),new X,new X,new H,new H,new H,new Z,new ct,new ct,new Y,new Y,new H(1,0,0),new H(0,1,0);var ye=function(t,e,i,r){return t[0]=e,t[1]=i,t[2]=r,t},pe=function(t,e,i){var r=e[0],n=e[1],s=e[2],a=i[3]*r+i[7]*n+i[11]*s+i[15];return t[0]=(i[0]*r+i[4]*n+i[8]*s+i[12])/(a||1),t[1]=(i[1]*r+i[5]*n+i[9]*s+i[13])/(a||1),t[2]=(i[2]*r+i[6]*n+i[10]*s+i[14])/(a||1),t},de=i(297),ve={radiusFactor:.75,intensityFactor:0,pressure:.5,getPressureIntensity:function(){return 1+ve.intensityFactor*(2*ve.pressure-1)},getPressureRadius:function(){return 1+ve.radiusFactor*(2*ve.pressure-1)}};const me=ve;var ge={SCALE:100,TAG_FLAG:1,SCULPT_FLAG:1,STATE_FLAG:1,TRI_INDEX:4294967295,cursors:{}};ge.cursors.dropper="url(resources/dropper.png) 5 25, auto",ge.linearToSRGB1=function(t){return t<.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055},ge.sRGBToLinear1=function(t){return t<.04045?t*(1/12.92):Math.pow((t+.055)*(1/1.055),2.4)},ge.extend=function(t,e){for(var i=Object.keys(e),r=0,n=i.length;r<n;++r){var s=i[r];void 0===t[s]&&(t[s]=e[s])}return t},ge.invert=function(t){for(var e=Object.keys(t),i={},r=0,n=e.length;r<n;++r)i[t[e[r]]]=e[r];return i},ge.replaceElement=function(t,e,i){for(var r=0,n=t.length;r<n;++r)if(t[r]===e)return void(t[r]=i)},ge.removeElement=function(t,e){for(var i=0,r=t.length;i<r;++i)if(t[i]===e)return t[i]=t[r-1],void t.pop()},ge.appendArray=function(t,e){var i=t.length,r=e.length;t.length+=r;for(var n=0;n<r;++n)t[i+n]=e[n]},ge.isPowerOfTwo=function(t){return 0!==t&&0==(t&t-1)},ge.nextHighestPowerOfTwo=function(t){--t;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1};var _e,be,ke=function(t,e){return t-e};ge.tidy=function(t){t.sort(ke);var e=t.length,i=0,r=0;for(i=1;i<e;++i)t[r]!==t[i]&&(t[++r]=t[i]);i>1&&(t.length=r+1)},ge.intersectionArrays=function(t,e){for(var i=0,r=0,n=[],s=t.length,a=e.length;i<s&&r<a;)t[i]<e[r]?i++:t[i]>e[r]?r++:(n.push(t[i]),++i,++r);return n},ge.littleEndian=(_e=new ArrayBuffer(2),new DataView(_e).setInt16(0,256,!0),256===new Int16Array(_e)[0]),ge.getBytes=function(t,e){return[t[e].charCodeAt(),t[e+1].charCodeAt(),t[e+2].charCodeAt(),t[e+3].charCodeAt()]},ge.getUint32=function(t,e){var i=ge.getBytes(t,e);return i[0]<<0|i[1]<<8|i[2]<<16|i[3]<<24},ge.getFloat32=function(t,e){var i=ge.getBytes(t,e),r=1-2*(i[3]>>7),n=(i[3]<<1&255|i[2]>>7)-127,s=(127&i[2])<<16|i[1]<<8|i[0];return 128===n?0!==s?NaN:r*(1/0):-127===n?r*s*Math.pow(2,-149):r*(1+s*Math.pow(2,-23))*Math.pow(2,n)},ge.ab2str=function(t){for(var e="",i=new Uint8Array(t),r=65535,n=0,s=i.length;n<s;n+=r){var a=i.subarray(n,r<s-n?r+n:s);e+=String.fromCharCode.apply(null,a)}return e},ge.getMemory=(be=new ArrayBuffer(1e5),function(t){return be.byteLength>=t?be:be=new ArrayBuffer(t)}),ge.now=Date.now||function(){return(new Date).getTime()},ge.throttle=function(t,e){var i,r=[],n=null,s=0,a=function(){s=ge.now(),n=null,i=t.apply(t,r)};return function(){for(var o=ge.now(),u=e-(o-s),h=r.length=arguments.length,l=0;l<h;++l)r[l]=arguments[l];return u<=0||u>e?(window.clearTimeout(n),n=null,s=o,i=t.apply(t,r)):n||(n=window.setTimeout(a,u)),i}},ge.normalizeArrayVec3=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=0,r=t.length/3;i<r;++i){var n=3*i,s=t[n],a=t[n+1],o=t[n+2],u=s*s+a*a+o*o;0!==u?(u=1/Math.sqrt(u),e[n]=s*u,e[n+1]=a*u,e[n+2]=o*u):e[n]=1}return e},ge.convertArrayVec3toSRGB=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=0,r=t.length;i<r;++i)e[i]=ge.linearToSRGB1(t[i]);return e},ge.convertArrayVec3toLinear=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=0,r=t.length;i<r;++i)e[i]=ge.sRGBToLinear1(t[i]);return e},ge.computeWorldVertices=function(t,e){var i=t.getNbVertices(),r=t.getVertices().subarray(0,3*i);e||(e=new Float32Array(3*i));for(var n=t.getMatrix(),s=new Float32Array(3),a=0;a<i;++a){var o=3*a;ye(s,r[o],r[o+1],r[o+2]),pe(s,s,n),e[o]=s[0],e[o+1]=s[1],e[o+2]=s[2]}return e};const xe=ge;var Me={Action:{NOTHING:0,MASK_EDIT:1,SCULPT_EDIT:2,CAMERA_ZOOM:3,CAMERA_ROTATE:4,CAMERA_PAN:5,CAMERA_PAN_ZOOM_ALT:6},Tools:{BRUSH:0,INFLATE:1,TWIST:2,SMOOTH:3,FLATTEN:4,PINCH:5,CREASE:6,DRAG:7,PAINT:8,MOVE:9,MASKING:10,LOCALSCALE:11,TRANSFORM:12,ELEMENTSELECT:13},Shader:{PBR:0,FLAT:1,NORMAL:2,WIREFRAME:3,UV:4,MATCAP:5,SELECTION:6,BACKGROUND:7,MERGE:8,FXAA:9,CONTOUR:10,PAINTUV:11,BLUR:12},Projection:{PERSPECTIVE:0,ORTHOGRAPHIC:1},CameraMode:{ORBIT:0,SPHERICAL:1,PLANE:2},MultiState:{NONE:0,SCULPT:1,CAMERA:2,PICKING:3}},we=Object.keys(Me.Tools).length;Me.KeyAction=xe.extend({INTENSITY:we++,RADIUS:we++,NEGATIVE:we++,PICKER:we++,DELETE:we++,CAMERA_FRONT:we++,CAMERA_TOP:we++,CAMERA_LEFT:we++,CAMERA_RESET:we++,STRIFE_LEFT:we++,STRIFE_RIGHT:we++,STRIFE_UP:we++,STRIFE_DOWN:we++,WIREFRAME:we++,REMESH:we++},Me.Tools);const Ae=Me;function Te(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}const Se=function(){function t(e,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._bufferAttribute=null,this._version=0}var e,i;return e=t,(i=[{key:"bind",value:function(){}},{key:"release",value:function(){this._bufferAttribute&&(this._bufferAttribute=null)}},{key:"update",value:function(t,e){t&&(this._bufferAttribute&&this._bufferAttribute.count===t.length/e?(this._bufferAttribute.set(t),this._bufferAttribute.needsUpdate=!0):(this._bufferAttribute=new Gt(t,e),this._bufferAttribute.setUsage(E)),this._version++)}},{key:"getBufferAttribute",value:function(){return this._bufferAttribute}}])&&Te(e.prototype,i),t}();function Ee(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ce={LINEAR:!1},Re=function(){function t(e,i,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._vArOut=i,this._cArOut=r,this._mArOut=n,this._vAr=e.getVertices(),this._cAr=e.getColors(),this._mAr=e.getMaterials(),this._eAr=e.getEdges(),this._nbVertices=e.getNbVertices(),this._tagEdges=new Int32Array(e.getNbEdges())}var e,i;return e=t,(i=[{key:"computeTriangleEdgeVertex",value:function(t,e,i,r){var n=this._vAr,s=this._cAr,a=this._mAr,o=this._eAr,u=this._vArOut,h=this._cArOut,l=this._mArOut,c=this._tagEdges,f=3*t,y=3*e,p=3*i,d=c[r]-1,v=-1===d?this._nbVertices++:d,m=3*v,g=o[r];if(1===g||g>=3||Ce.LINEAR){if(-1!==d)return v;c[r]=v+1,u[m]=.5*(n[f]+n[y]),u[m+1]=.5*(n[f+1]+n[y+1]),u[m+2]=.5*(n[f+2]+n[y+2]),h[m]=.5*(s[f]+s[y]),h[m+1]=.5*(s[f+1]+s[y+1]),h[m+2]=.5*(s[f+2]+s[y+2]),l[m]=.5*(a[f]+a[y]),l[m+1]=.5*(a[f+1]+a[y+1]),l[m+2]=.5*(a[f+2]+a[y+2])}else-1===d?(c[r]=v+1,u[m]=.125*n[p]+.375*(n[f]+n[y]),u[m+1]=.125*n[p+1]+.375*(n[f+1]+n[y+1]),u[m+2]=.125*n[p+2]+.375*(n[f+2]+n[y+2]),h[m]=.125*s[p]+.375*(s[f]+s[y]),h[m+1]=.125*s[p+1]+.375*(s[f+1]+s[y+1]),h[m+2]=.125*s[p+2]+.375*(s[f+2]+s[y+2]),l[m]=.125*a[p]+.375*(a[f]+a[y]),l[m+1]=.125*a[p+1]+.375*(a[f+1]+a[y+1]),l[m+2]=.125*a[p+2]+.375*(a[f+2]+a[y+2])):(u[m]+=.125*n[p],u[m+1]+=.125*n[p+1],u[m+2]+=.125*n[p+2],h[m]+=.125*s[p],h[m+1]+=.125*s[p+1],h[m+2]+=.125*s[p+2],l[m]+=.125*a[p],l[m+1]+=.125*a[p+1],l[m+2]+=.125*a[p+2]);return v}},{key:"computeQuadEdgeVertex",value:function(t,e,i,r,n){var s=this._vAr,a=this._cAr,o=this._mAr,u=this._eAr,h=this._vArOut,l=this._cArOut,c=this._mArOut,f=this._tagEdges,y=3*t,p=3*e,d=3*i,v=3*r,m=f[n]-1,g=-1===m?this._nbVertices++:m,_=3*g,b=u[n];if(1===b||b>=3||Ce.LINEAR){if(-1!==m)return g;f[n]=g+1,h[_]=.5*(s[y]+s[p]),h[_+1]=.5*(s[y+1]+s[p+1]),h[_+2]=.5*(s[y+2]+s[p+2]),l[_]=.5*(a[y]+a[p]),l[_+1]=.5*(a[y+1]+a[p+1]),l[_+2]=.5*(a[y+2]+a[p+2]),c[_]=.5*(o[y]+o[p]),c[_+1]=.5*(o[y+1]+o[p+1]),c[_+2]=.5*(o[y+2]+o[p+2])}else-1===m?(f[n]=g+1,h[_]=.0625*(s[d]+s[v])+.375*(s[y]+s[p]),h[_+1]=.0625*(s[d+1]+s[v+1])+.375*(s[y+1]+s[p+1]),h[_+2]=.0625*(s[d+2]+s[v+2])+.375*(s[y+2]+s[p+2]),l[_]=.0625*(a[d]+a[v])+.375*(a[y]+a[p]),l[_+1]=.0625*(a[d+1]+a[v+1])+.375*(a[y+1]+a[p+1]),l[_+2]=.0625*(a[d+2]+a[v+2])+.375*(a[y+2]+a[p+2]),c[_]=.0625*(o[d]+o[v])+.375*(o[y]+o[p]),c[_+1]=.0625*(o[d+1]+o[v+1])+.375*(o[y+1]+o[p+1]),c[_+2]=.0625*(o[d+2]+o[v+2])+.375*(o[y+2]+o[p+2])):(h[_]+=.0625*(s[d]+s[v]),h[_+1]+=.0625*(s[d+1]+s[v+1]),h[_+2]+=.0625*(s[d+2]+s[v+2]),l[_]+=.0625*(a[d]+a[v]),l[_+1]+=.0625*(a[d+1]+a[v+1]),l[_+2]+=.0625*(a[d+2]+a[v+2]),c[_]+=.0625*(o[d]+o[v]),c[_+1]+=.0625*(o[d+1]+o[v+1]),c[_+2]+=.0625*(o[d+2]+o[v+2]));return g}},{key:"computeFaceVertex",value:function(t,e,i,r){var n=3*t,s=3*e,a=3*i,o=3*r,u=this._vAr,h=this._cAr,l=this._mAr,c=this._vArOut,f=this._cArOut,y=this._mArOut,p=this._nbVertices++,d=3*p;return c[d]=.25*(u[n]+u[s]+u[a]+u[o]),c[d+1]=.25*(u[n+1]+u[s+1]+u[a+1]+u[o+1]),c[d+2]=.25*(u[n+2]+u[s+2]+u[a+2]+u[o+2]),f[d]=.25*(h[n]+h[s]+h[a]+h[o]),f[d+1]=.25*(h[n+1]+h[s+1]+h[a+1]+h[o+1]),f[d+2]=.25*(h[n+2]+h[s+2]+h[a+2]+h[o+2]),y[d]=.25*(l[n]+l[s]+l[a]+l[o]),y[d+1]=.25*(l[n+1]+l[s+1]+l[a+1]+l[o+1]),y[d+2]=.25*(l[n+2]+l[s+2]+l[a+2]+l[o+2]),p}}])&&Ee(e.prototype,i),t}(),Ie=function(t,e,i,r){var n=t.getNbVertices();i.set(t.getColors().subarray(0,3*n)),r.set(t.getMaterials().subarray(0,3*n));for(var s=t.getVertices(),a=t.getFaces(),o=t.getEdges(),u=t.getFaceEdges(),h=t.getVerticesOnEdge(),l=t.getVerticesRingVertStartCount(),c=t.getVerticesRingVert(),f=t.getVerticesRingFaceStartCount(),y=t.getVerticesRingFace(),p=t.hasOnlyTriangles(),d=0;d<n;++d){var v=3*d,m=0,g=0,_=0,b=0,k=0,x=0,M=0;if(h[d]||Ce.LINEAR){var w=f[2*d],A=w+f[2*d+1];for(x=w;x<A;++x){var T=4*y[x],S=a[T],E=a[T+1],C=a[T+2],R=a[T+3],I=R===xe.TRI_INDEX;M=xe.TRI_INDEX,S===d?1===o[u[T]]?M=E:1===o[u[I?T+2:T+3]]&&(M=I?C:R):E===d?1===o[u[T]]?M=S:1===o[u[T+1]]&&(M=C):C===d?1===o[u[T+1]]?M=E:1===o[u[T+2]]&&(M=I?S:R):R===d&&(1===o[u[T+2]]?M=C:1===o[u[T+3]]&&(M=S)),M!==xe.TRI_INDEX&&(m+=s[M*=3],g+=s[M+1],_+=s[M+2],b++)}b<2?(e[v]=s[v],e[v+1]=s[v+1],e[v+2]=s[v+2]):(b=.25/b,k=.75,e[v]=s[v]*k+m*b,e[v+1]=s[v+1]*k+g*b,e[v+2]=s[v+2]*k+_*b)}else{var N=l[2*d],z=l[2*d+1],O=N+z;for(x=N;x<O;++x)m+=s[M=3*c[x]],g+=s[M+1],_+=s[M+2];if(p)6===z?(b=.0625,k=.625):3===z?(b=.1875,k=.4375):(b=.375/z,k=.625),e[v]=s[v]*k+m*b,e[v+1]=s[v+1]*k+g*b,e[v+2]=s[v+2]*k+_*b;else{var F=0,P=0,V=0,D=0,U=f[2*d],L=U+f[2*d+1],W=0;for(x=U;x<L;++x){var B=a[3+(M=4*y[x])];if(B!==xe.TRI_INDEX){W++;var j,X=a[M],Y=a[M+1],H=a[M+2];F+=s[j=X===d?3*H:Y===d?3*B:H===d?3*X:3*Y],P+=s[j+1],V+=s[j+2]}}W!==L-U?0!==W?(b=.5*(k=1/(1+.5*z+.25*W)),D=.25*k,e[v]=s[v]*k+m*b+F*D,e[v+1]=s[v+1]*k+g*b+P*D,e[v+2]=s[v+2]*k+_*b+V*D):(6===z?(b=.0625,k=.625):3===z?(b=.1875,k=.4375):(b=.375/z,k=.625),e[v]=s[v]*k+m*b,e[v+1]=s[v+1]*k+g*b,e[v+2]=s[v+2]*k+_*b):(4===z?(k=.5625,b=.09375,D=.015625):k=1-((b=1.5/(z*z))+(D=.25/(z*z)))*z,e[v]=s[v]*k+m*b+F*D,e[v+1]=s[v+1]*k+g*b+P*D,e[v+2]=s[v+2]*k+_*b+V*D)}}}},Ne=function(t,e,i,r,n){for(var s=t.getFaces(),a=t.getFaceEdges(),o=new Re(t,e,i,r),u=0,h=t.getNbFaces();u<h;++u){var l,c,f,y,p,d=4*u,v=s[d],m=s[d+1],g=s[d+2],_=s[d+3],b=_!==xe.TRI_INDEX;b?(l=o.computeQuadEdgeVertex(v,m,g,_,a[d]),c=o.computeQuadEdgeVertex(m,g,_,v,a[d+1]),f=o.computeQuadEdgeVertex(g,_,v,m,a[d+2]),y=o.computeQuadEdgeVertex(_,v,m,g,a[d+3]),p=o.computeFaceVertex(v,m,g,_)):(l=o.computeTriangleEdgeVertex(v,m,g,a[d]),c=o.computeTriangleEdgeVertex(m,g,v,a[d+1]),f=o.computeTriangleEdgeVertex(g,v,m,a[d+2])),n&&(d*=4,b?(n[d+1]=n[d+4]=l,n[d+6]=n[d+9]=c,n[d+11]=n[d+14]=f,n[d+3]=n[d+12]=y,n[d+2]=n[d+7]=n[d+8]=n[d+13]=p,n[d]=v,n[d+5]=m,n[d+10]=g,n[d+15]=_):(n[d]=n[d+5]=n[d+8]=l,n[d+1]=n[d+10]=n[d+12]=c,n[d+2]=n[d+6]=n[d+14]=f,n[d+3]=n[d+7]=n[d+11]=n[d+15]=xe.TRI_INDEX,n[d+4]=v,n[d+9]=m,n[d+13]=g))}return o._tagEdges};Ce.fullSubdivision=function(t,e){var i=t.getNbVertices()+t.getNbEdges()+t.getNbQuads();e.setVertices(new Float32Array(3*i)),e.setColors(new Float32Array(3*i)),e.setMaterials(new Float32Array(3*i)),e.setFaces(new Uint32Array(4*t.getNbFaces()*4)),Ie(t,e.getVertices(),e.getColors(),e.getMaterials());var r=Ne(t,e.getVertices(),e.getColors(),e.getMaterials(),e.getFaces());t.hasUV()&&function(t,e,i){var r=e.getNbVertices(),n=new Uint32Array(2*r);n.set(t.getVerticesDuplicateStartCount());var s=t.getFaces(),a=t.getFacesTexCoord(),o=3*e.getNbFaces(),u=t.getTexCoords(),h=new Float32Array(xe.getMemory(4*o*2),0,2*o),l=0,c=t.getNbVertices(),f=r-c;for(l=0;l<c;++l){var y=n[2*l];y>0&&(n[2*l]=y+f)}h.set(u),h.set(u.subarray(2*c),2*(c+f));var p=f+t.getNbTexCoords(),d=t.getFaceEdges(),v=new Uint32Array(i.length),m=new Uint32Array(i.length);for(c=s.length,l=0;l<c;++l){var g=d[l];if(g!==xe.TRI_INDEX){var _=(l+1)%4==0?l-3:l+1,b=a[l],k=a[_];k===xe.TRI_INDEX&&(k=a[l-2]);var x=i[g]-1,M=m[g],w=b>k?b:k,A=b<k?b:k;0!==M?M===w&&v[g]===A||(h[2*p]=.5*(u[2*b]+u[2*k]),h[2*p+1]=.5*(u[2*b+1]+u[2*k+1]),n[2*x]=p++,n[2*x+1]=1):(h[2*x]=.5*(u[2*b]+u[2*k]),h[2*x+1]=.5*(u[2*b+1]+u[2*k+1]),v[g]=A,m[g]=w)}}var T=new Float32Array(2*p);T.set(h.subarray(0,2*p)),e.setTexCoords(T),e.setVerticesDuplicateStartCount(n),function(t,e,i){for(var r=t.getFacesTexCoord(),n=e.getFaces(),s=new Uint32Array(n.length),a=t.getFaceEdges(),o=t.getNbVertices(),u=e.getNbVertices()-o,h=e.getVerticesDuplicateStartCount(),l=e.getTexCoords(),c=0,f=t.getNbFaces();c<f;++c){var y=4*c,p=r[y],d=r[y+1],v=r[y+2],m=r[y+3];p>=o&&(p+=u),d>=o&&(d+=u),v>=o&&(v+=u),m!==xe.TRI_INDEX&&m>=o&&(m+=u);var g=a[y],_=i[g]-1;_<0?_=h[2*(-_-1)]:h[2*_]>0&&(i[g]=-_);var b=i[g=a[y+1]]-1;b<0?b=h[2*(-b-1)]:h[2*b]>0&&(i[g]=-b);var k=i[g=a[y+2]]-1;if(k<0?k=h[2*(-k-1)]:h[2*k]>0&&(i[g]=-k),y*=4,m!==xe.TRI_INDEX){var x=i[g=a[4*c+3]]-1;x<0?x=h[2*(-x-1)]:h[2*x]>0&&(i[g]=-x),s[y+1]=s[y+4]=_,s[y+6]=s[y+9]=b,s[y+11]=s[y+14]=k,s[y+3]=s[y+12]=x,s[y+2]=s[y+7]=s[y+8]=s[y+13]=n[y+2],s[y]=p,s[y+5]=d,s[y+10]=v,s[y+15]=m;var M=2*n[y+2];l[M]=.25*(l[2*p]+l[2*d]+l[2*v]+l[2*m]),l[M+1]=.25*(l[2*p+1]+l[2*d+1]+l[2*v+1]+l[2*m+1])}else s[y]=s[y+5]=s[y+8]=_,s[y+1]=s[y+10]=s[y+12]=b,s[y+2]=s[y+6]=s[y+14]=k,s[y+3]=s[y+7]=s[y+11]=s[y+15]=xe.TRI_INDEX,s[y+4]=p,s[y+9]=d,s[y+13]=v}e.setFacesTexCoord(s)}(t,e,i)}(t,e,r),e.allocateArrays()},Ce.partialSubdivision=function(t,e,i,r){Ie(t,e,i,r),Ne(t,e,i,r)};const ze=Ce;function Oe(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}const Fe=function(){function t(e,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._bufferAttribute=null,this._version=0}var e,i;return e=t,(i=[{key:"bind",value:function(){}},{key:"release",value:function(){this._bufferAttribute&&(this._bufferAttribute=null)}},{key:"update",value:function(t,e){t&&(this._bufferAttribute&&this._bufferAttribute.count===t.length/e?(this._bufferAttribute.set(t),this._bufferAttribute.needsUpdate=!0):(this._bufferAttribute=new Gt(t,e),this._bufferAttribute.setUsage(E)),this._version++)}},{key:"getBufferAttribute",value:function(){return this._bufferAttribute}}])&&Oe(e.prototype,i),t}();function Pe(t){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ve(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function De(t,e){return(De=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ue(t,e){return!e||"object"!==Pe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Le(t){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const We=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&De(t,e)}(a,t);var e,i,r,n,s=(r=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Le(r);if(n){var i=Le(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return Ue(this,t)});function a(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this)).setID(t.getID()),i.setMeshData(e?t.getMeshData():{_nbVertices:0,_nbFaces:0,_nbTexCoords:0,_verticesXYZ:null,_normalsXYZ:null,_colorsRGB:null,_materialsPBR:null,_vertOnEdge:null,_vertRingFace:null,_vrfStartCount:null,_vrvStartCount:null,_vertRingVert:null,_vertTagFlags:null,_vertSculptFlags:null,_vertStateFlags:null,_vertProxy:null,_facesABCD:null,_faceEdges:null,_faceNormalsXYZ:null,_facesToTriangles:null,_trianglesABC:null,_facesTagFlags:null,_edges:null,_drawArraysWireframe:null,_drawElementsWireframe:null,_texCoordsST:null,_duplicateStartCount:null,_UVfacesABCD:null,_UVtrianglesABC:null,_DAverticesXYZ:null,_DAnormalsXYZ:null,_DAcolorsRGB:null,_DAmaterialsPBR:null,_DAtexCoordsST:null,_octree:null,_faceBoxes:null,_faceCentersXYZ:null,_facePosInLeaf:null,_faceLeaf:[],_leavesToUpdate:[],_worldBound:[1/0,1/0,1/0,-1/0,-1/0,-1/0]}),i.setRenderData(t.getRenderData()),i.setTransformData(t.getTransformData()),i._detailsXYZ=null,i._detailsRGB=null,i._detailsPBR=null,i._vertMapping=null,i._evenMapping=!1,i}return e=a,(i=[{key:"optimize",value:function(){}},{key:"getEvenMapping",value:function(){return this._evenMapping}},{key:"getVerticesMapping",value:function(){return this._vertMapping}},{key:"setVerticesMapping",value:function(t){this._vertMapping=t}},{key:"setEvenMapping",value:function(t){this._evenMapping=t}},{key:"higherSynthesis",value:function(t){t.computePartialSubdivision(this.getVertices(),this.getColors(),this.getMaterials(),this.getNbVertices()),this.applyDetails()}},{key:"lowerAnalysis",value:function(t){this.copyDataFromHigherRes(t);var e=t.getNbVertices(),i=new Float32Array(3*e),r=new Float32Array(3*e),n=new Float32Array(3*e);this.computePartialSubdivision(i,r,n,e),t.computeDetails(i,r,n,e)}},{key:"copyDataFromHigherRes",value:function(t){var e=this.getVertices(),i=this.getColors(),r=this.getMaterials(),n=this.getNbVertices(),s=t.getVertices(),a=t.getColors(),o=t.getMaterials();if(!1===this.getEvenMapping())e.set(s.subarray(0,3*n)),i.set(a.subarray(0,3*n)),r.set(o.subarray(0,3*n));else for(var u=this.getVerticesMapping(),h=0;h<n;++h){var l=3*h,c=3*u[h];e[l]=s[c],e[l+1]=s[c+1],e[l+2]=s[c+2],i[l]=a[c],i[l+1]=a[c+1],i[l+2]=a[c+2],r[l]=o[c],r[l+1]=o[c+1],r[l+2]=o[c+2]}}},{key:"computePartialSubdivision",value:function(t,e,i,r){var n=this.getVerticesMapping();if(n){var s=new Float32Array(3*r),a=new Float32Array(3*r),o=new Float32Array(3*r);ze.partialSubdivision(this,s,a,o);var u=!0===this.getEvenMapping()?0:this.getNbVertices();u>0&&(t.set(s.subarray(0,3*u)),e.set(a.subarray(0,3*u)),i.set(o.subarray(0,3*u)));for(var h=u;h<r;++h){var l=3*h,c=3*n[h];t[c]=s[l],t[c+1]=s[l+1],t[c+2]=s[l+2],e[c]=a[l],e[c+1]=a[l+1],e[c+2]=a[l+2],i[c]=o[l],i[c+1]=o[l+1],i[c+2]=o[l+2]}}else ze.partialSubdivision(this,t,e,i)}},{key:"applyDetails",value:function(){var t=this.getVerticesRingVertStartCount(),e=this.getVerticesRingVert(),i=this.getVertices(),r=this.getNormals(),n=this.getColors(),s=this.getMaterials(),a=this.getNbVertices(),o=new Float32Array(xe.getMemory(3*a*4),0,3*a);o.set(i.subarray(0,3*a));for(var u=this._detailsXYZ,h=this._detailsRGB,l=this._detailsPBR,c=Math.min,f=Math.max,y=0;y<a;++y){var p=3*y;n[p]=c(1,f(0,n[p]+h[p])),n[p+1]=c(1,f(0,n[p+1]+h[p+1])),n[p+2]=c(1,f(0,n[p+2]+h[p+2])),s[p]=c(1,f(0,s[p]+l[p])),s[p+1]=c(1,f(0,s[p+1]+l[p+1])),s[p+2]=c(1,f(0,s[p+2]+l[p+2]));var d=o[p],v=o[p+1],m=o[p+2],g=r[p],_=r[p+1],b=r[p+2],k=g*g+_*_+b*b;if(0!==k){g*=k=1/Math.sqrt(k),_*=k,b*=k;var x=3*e[t[2*y]],M=o[x]-d,w=o[x+1]-v,A=o[x+2]-m;if(0!=(k=(M-=g*(k=M*g+w*_+A*b))*M+(w-=_*k)*w+(A-=b*k)*A)){var T=_*(A*=k=1/Math.sqrt(k))-b*(w*=k),S=b*(M*=k)-g*A,E=g*w-_*M,C=u[p],R=u[p+1],I=u[p+2];i[p]=d+g*C+M*R+T*I,i[p+1]=v+_*C+w*R+S*I,i[p+2]=m+b*C+A*R+E*I}}}}},{key:"computeDetails",value:function(t,e,i,r){for(var n=this.getVerticesRingVertStartCount(),s=this.getVerticesRingVert(),a=this.getVertices(),o=this.getNormals(),u=this.getColors(),h=this.getMaterials(),l=this.getNbVertices(),c=this._detailsXYZ=new Float32Array(3*r),f=this._detailsRGB=new Float32Array(3*r),y=this._detailsPBR=new Float32Array(3*r),p=0;p<l;++p){var d=3*p;f[d]=u[d]-e[d],f[d+1]=u[d+1]-e[d+1],f[d+2]=u[d+2]-e[d+2],y[d]=h[d]-i[d],y[d+1]=h[d+1]-i[d+1],y[d+2]=h[d+2]-i[d+2];var v=o[d],m=o[d+1],g=o[d+2],_=v*v+m*m+g*g;if(0!==_){v*=_=1/Math.sqrt(_),m*=_,g*=_;var b=3*s[n[2*p]],k=t[b]-t[d],x=t[b+1]-t[d+1],M=t[b+2]-t[d+2];if(0!=(_=(k-=v*(_=k*v+x*m+M*g))*k+(x-=m*_)*x+(M-=g*_)*M)){var w=m*(M*=_=1/Math.sqrt(_))-g*(x*=_),A=g*(k*=_)-v*M,T=v*x-m*k,S=a[d]-t[d],E=a[d+1]-t[d+1],C=a[d+2]-t[d+2];c[d]=v*S+m*E+g*C,c[d+1]=k*S+x*E+M*C,c[d+2]=w*S+A*E+T*C}}}}}])&&Ve(e.prototype,i),a}(Fe);function Be(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}const je=function(){function t(e,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._bufferAttribute=null,this._version=0}var e,i;return e=t,(i=[{key:"bind",value:function(){}},{key:"release",value:function(){this._bufferAttribute&&(this._bufferAttribute=null)}},{key:"update",value:function(t,e){t&&(this._bufferAttribute&&this._bufferAttribute.count===t.length/e?(this._bufferAttribute.set(t),this._bufferAttribute.needsUpdate=!0):(this._bufferAttribute=new Gt(t,e),this._bufferAttribute.setUsage(E)),this._version++)}},{key:"getBufferAttribute",value:function(){return this._bufferAttribute}}])&&Be(e.prototype,i),t}();var Xe={},Ye=function(t,e,i){var r=++xe.TAG_FLAG,n=t.getVerticesTagFlags(),s=t.getVerticesRingVertStartCount(),a=t.getVerticesRingVert(),o=t.getVerticesOnEdge(),u=function(t,e,i){var r=0,n=t.getNbVertices();for(r=0;r<n;++r)if(0===e[r]&&1===i[r])return r;var s=t.getVerticesOnEdge();for(r=0;r<n&&(0!==e[r]||1===s[r]);++r);if(r===n)return-1;for(r=0;r<n;++r)if(0===e[r])return r;return-1}(t,i,e);if(u<0)return!1;i[u]=1;var h=new Uint32Array(xe.getMemory(4*t.getNbVertices()),0,t.getNbVertices());h[0]=u;for(var l=1;l>0;){var c=h[--l],f=s[2*c],y=f+s[2*c+1],p=0,d=++r;for(p=f;p<y;++p){var v=a[p];if(n[v]=d,1===i[v])return xe.TAG_FLAG=r,!1;i[v]=-1,n[v]=d}for(d=++r,p=f;p<y;++p){var m=a[p];if(0!==e[m]&&!o[m])return xe.TAG_FLAG=r,!1;for(var g=s[2*m],_=g+s[2*m+1],b=g;b<_;++b){var k=a[b];if(k!==c&&!(n[k]>=d-1)&&(n[k]=d,0===i[k])){for(var x=s[2*k],M=x+s[2*k+1],w=0,A=x;A<M;++A)n[a[A]]===d-1&&w++;2===w?i[k]=-1:(i[k]=1,h[l++]=k)}}}}return xe.TAG_FLAG=r,!0};Xe.computeReverse=function(t,e){var i=t.getNbFaces();if(i%4!=0)return!1;var r=new Int8Array(t.getNbVertices());if(!function(t,e){for(var i=t.getNbVertices(),r=function(t){for(var e=t.getNbVertices(),i=t.getFaces(),r=t.getVerticesOnEdge(),n=t.getVerticesRingVertStartCount(),s=t.getVerticesRingFace(),a=t.getVerticesRingFaceStartCount(),o=new Int8Array(e),u=0;u<e;++u){for(var h=2*u,l=n[h+1],c=a[h],f=a[h+1],y=r[u],p=0,d=c,v=c+f;d<v;++d)p+=i[4*s[d]+3]===xe.TRI_INDEX?0:1;0===p?(!y&&6!==l||y&&4!==l)&&(o[u]=1):p===f?(!y&&4!==l||y&&3!==l)&&(o[u]=1):(y||5!==l)&&(o[u]=1)}return o}(t),n=!0;n;){if(!Ye(t,r,e))return!1;n=!1;for(var s=0;s<i;++s)if(0===e[s]){n=!0;break}}return!0}(t,r))return!1;var n=new Int32Array(i/4);return!!function(t,e,i,r){var n=t.getFaceEdges(),s=t.getFaces(),a=new Int32Array(t.getNbEdges()),o=0,u=t.getNbFaces(),h=0,l=new Uint32Array(t.getNbVertices()),c=new Uint32Array(u);for(o=0;o<u;++o)c[o]=xe.TRI_INDEX;for(o=0;o<u;++o){var f=4*o,y=s[f],p=s[f+1],d=s[f+2],v=s[f+3],m=i[y],g=i[p],_=i[d];if(v!==xe.TRI_INDEX){var b=0,k=0,x=0;1===m?(b=y,k=d,x=a[n[f+1]]-1,a[n[f+2]]=y+1):1===g?(b=p,k=v,x=a[n[f+2]]-1,a[n[f+3]]=p+1):1===_?(b=d,k=y,x=a[n[f+3]]-1,a[n[f]]=d+1):(b=v,k=p,x=a[n[f]]-1,a[n[f+1]]=v+1);var M=l[k]-1;if(M<0)r[h]=-k-1,c[4*h+3]=b,l[k]=++h;else{var w=4*M;x<0?c[w+2]>=xe.TRI_INDEX-1?(c[w+2]=b,c[w]=xe.TRI_INDEX-1):c[w]===xe.TRI_INDEX?c[w+1]=b:(c[w+1]=c[w+2],c[w+2]=b):c[w+1]===x?c[w]=b:(c[w]=c[w+1],c[w+2]===x?c[w+1]=b:(c[w+1]=c[w+2],c[w+2]=b))}}else{if(m+g+_===-3){r[h++]=o;continue}1===m?a[n[f+1]]=y+1:1===g?a[n[f+2]]=p+1:1===_&&(a[n[f]]=d+1)}}for(u/=4,o=0;o<u;++o){var A=r[o],T=4*o;if(A<0){var S=xe.TRI_INDEX-1;if(c[T]>=S||c[T+1]>=xe.TRI_INDEX||c[T+2]>=xe.TRI_INDEX)return!1}else{var E=4*A;c[T]=a[n[E]]-1,c[T+1]=a[n[E+1]]-1,c[T+2]=a[n[E+2]]-1}}return e.setFaces(c),!0}(t,e,r,n)&&(function(t,e,i){var r=0,n=new Uint32Array(t.getNbVertices());e.setVerticesMapping(n);var s=e.getFaces(),a=new Int32Array(t.getNbVertices()),o=0,u=4*e.getNbFaces();for(o=0;o<u;++o){var h=s[o];if(h!==xe.TRI_INDEX){var l=a[h]-1;-1===l&&(l=r++,a[h]=l+1,n[l]=h),s[o]=l}}e.setVertices(new Float32Array(3*r));var c=t.getFaces(),f=t.getVerticesRingFace(),y=t.getVerticesRingFaceStartCount(),p=new Uint8Array(t.getNbVertices());for(u/=4,o=0;o<u;++o){var d,v,m,g,_,b,k,x,M,w,A=i[o];if(A>=0){var T=4*A;d=c[T+1],v=c[T+2],m=c[T],g=xe.TRI_INDEX,_=xe.TRI_INDEX}else{_=-A-1;for(var S=4*o,E=n[s[S]],C=n[s[S+1]],R=n[s[S+2]],I=n[s[S+3]],N=y[2*_],z=N+4,O=N;O<z;++O){var F=4*f[O],P=c[F],V=c[F+1],D=c[F+2],U=c[F+3];P===E?d=V:V===E?d=D:D===E?d=U:U===E&&(d=P),P===C?v=V:V===C?v=D:D===C?v=U:U===C&&(v=P),P===R?m=V:V===R?m=D:D===R?m=U:U===R&&(m=P),P===I?g=V:V===I?g=D:D===I?g=U:U===I&&(g=P)}}b=p[d],k=p[v],x=p[m],M=g!==xe.TRI_INDEX?p[g]:-1,w=_!==xe.TRI_INDEX?p[_]:-1,0===b&&(p[d]=1,n[r++]=d),0===k&&(p[v]=1,n[r++]=v),0===x&&(p[m]=1,n[r++]=m),0===M&&(p[g]=1,n[r++]=g),0===w&&(p[_]=1,n[r++]=_)}}(t,e,n),function(t,e){var i=t.getVertices(),r=t.getColors(),n=t.getMaterials(),s=e.getVertices(),a=new Float32Array(s.length),o=new Float32Array(s.length);e.setColors(a),e.setMaterials(o);var u=e.getVerticesMapping(),h=0,l=e.getNbVertices();for(h=0;h<l&&!(u[h]>=l);++h);if(h===l){var c=e.getFaces(),f=c.length;for(h=0;h<f;++h){var y=c[h];y!==xe.TRI_INDEX&&(c[h]=u[y])}for(h=0;h<l;++h)u[h]=h;s.set(i.subarray(0,3*l)),a.set(r.subarray(0,3*l)),o.set(n.subarray(0,3*l))}else for(e.setEvenMapping(!0),h=0;h<l;++h){var p=3*h,d=3*u[h];s[p]=i[d],s[p+1]=i[d+1],s[p+2]=i[d+2],a[p]=r[d],a[p+1]=r[d+1],a[p+2]=r[d+2],o[p]=n[d],o[p+1]=n[d+1],o[p+2]=n[d+2]}}(t,e),t.hasUV()&&function(t,e,i){for(var r=t.getVerticesDuplicateStartCount(),n=e.getNbVertices(),s=new Uint32Array(2*n),a=e.getVerticesMapping(),o=t.getTexCoords(),u=new Float32Array(xe.getMemory(4*t.getNbTexCoords()*2),0,2*t.getNbTexCoords()),h=new Uint32Array(n),l=n,c=0;c<n;++c){var f=a[c],y=r[2*f];if(u[2*c]=o[2*f],u[2*c+1]=o[2*f+1],0!==y){for(var p=h[c]=y-l,d=r[2*f+1],v=l,m=l+d;v<m;++v)u[2*v]=o[2*(p+v)],u[2*v+1]=o[2*(p+v)+1];s[2*c]=l,s[2*c+1]=d,l+=d}}e.setTexCoords(new Float32Array(u.subarray(0,2*l))),e.setVerticesDuplicateStartCount(s),function(t,e,i,r){for(var n=t.getFaces(),s=t.getFacesTexCoord(),a=t.getVerticesRingFaceStartCount(),o=t.getVerticesRingFace(),u=t.getVerticesDuplicateStartCount(),h=e.getFaces(),l=new Uint32Array(h),c=e.getVerticesMapping(),f=0,y=h.length;f<y;++f){var p=h[f];if(p!==xe.TRI_INDEX){var d=c[p];if(0!==u[2*d]){var v=f%4,m=i[(f-v)/4],g=xe.TRI_INDEX;if(m>=0){var _,b,k=4*m;0===v?(_=n[k+1],b=n[k]):1===v?(_=n[k+2],b=n[k+1]):(_=n[k],b=n[k+2]);for(var x=a[2*d],M=x+a[2*d+1],w=x;w<M;++w){var A=4*o[w],T=n[A],S=n[A+1],E=n[A+2];if(T===_?S===b&&(g=s[A+2]):S===_?E===b&&(g=s[A]):E===_&&T===b&&(g=s[A+1]),g!==xe.TRI_INDEX)break}}else for(var C=a[2*(m=-m-1)],R=C+4,I=C;I<R;++I){var N=4*o[I];if(n[N]===d?g=s[N]:n[N+1]===d?g=s[N+1]:n[N+2]===d?g=s[N+2]:n[N+3]===d&&(g=s[N+3]),g!==xe.TRI_INDEX)break}l[f]=g===d?g:g-r[p]}}}e.setFacesTexCoord(l)}(t,e,i,h)}(t,e,n),e.allocateArrays(),!0)};const He=Xe;function qe(t){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ge(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ze(t,e,i){return(Ze="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qe(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function Ke(t,e){return(Ke=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Je(t,e){return!e||"object"!==qe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qe(t){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ke(t,e)}(o,t);var e,i,r,n,s,a=(n=o,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Qe(n);if(s){var i=Qe(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return Je(this,t)});function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).setID(t.getID()),e.setRenderData(t.getRenderData()),e.setTransformData(t.getTransformData()),e._meshes=[new We(t,!0)],e.setSelection(0);var i=t.getGL();return e._indexBuffer=new je(i,i.ELEMENT_ARRAY_BUFFER,i.STATIC_DRAW),e._wireframeBuffer=new je(i,i.ELEMENT_ARRAY_BUFFER,i.STATIC_DRAW),e}return e=o,r=[{key:"NONE",get:function(){return 0}},{key:"SCULPT",get:function(){return 1}},{key:"CAMERA",get:function(){return 2}},{key:"PICKING",get:function(){return 3}}],(i=[{key:"getCurrentMesh",value:function(){return this._meshes[this._sel]}},{key:"setSelection",value:function(t){this._sel=t,this.setMeshData(this.getCurrentMesh().getMeshData())}},{key:"addLevel",value:function(){if(this._meshes.length-1!==this._sel)return this.getCurrentMesh();var t=this.getCurrentMesh().getNbFaces(),e="addLevel : "+t+" -> "+4*t;console.time(e);var i=this.getCurrentMesh(),r=new We(i);return i.setVerticesMapping(void 0),ze.fullSubdivision(i,r),r.initTopology(),this.pushMesh(r),this.initRender(),console.timeEnd(e),r}},{key:"computeReverse",value:function(){if(0!==this._sel)return this.getCurrentMesh();var t=this.getCurrentMesh(),e=new We(t);return He.computeReverse(t,e)?(e.initTopology(),this.unshiftMesh(e),this.initRender(),e):void 0}},{key:"lowerLevel",value:function(){return 0===this._sel?this._meshes[0]:(this._meshes[this._sel-1].lowerAnalysis(this.getCurrentMesh()),this.setSelection(this._sel-1),this.updateResolution(),this.getCurrentMesh())}},{key:"higherLevel",value:function(){return this._sel===this._meshes.length-1||(this._meshes[this._sel+1].higherSynthesis(this.getCurrentMesh()),this.setSelection(this._sel+1),this.updateResolution()),this.getCurrentMesh()}},{key:"updateResolution",value:function(){this.updateGeometry(),this.updateDuplicateColorsAndMaterials(),this.updateBuffers();var t=this._meshes[this.getLowIndexRender()];this._indexBuffer.update(t.getTriangles()),this._wireframeBuffer.update(t.getWireframe())}},{key:"selectResolution",value:function(t){for(;this._sel>t;)this.lowerLevel();for(;this._sel<t;)this.higherLevel()}},{key:"findIndexFromMesh",value:function(t){for(var e=this._meshes,i=0,r=e.length;i<r;++i)if(t===e[i])return i}},{key:"selectMesh",value:function(t){var e=this.findIndexFromMesh(t);this.selectResolution(e)}},{key:"pushMesh",value:function(t){this._meshes.push(t),this.setSelection(this._meshes.length-1),this.updateResolution()}},{key:"unshiftMesh",value:function(t){this._meshes.unshift(t),this.setSelection(1),this.lowerLevel()}},{key:"popMesh",value:function(){this._meshes.pop(),this.setSelection(this._meshes.length-1),this.updateResolution()}},{key:"shiftMesh",value:function(){this._meshes.shift(),this.setSelection(0),this.updateResolution()}},{key:"deleteLower",value:function(){this._meshes.splice(0,this._sel),this.setSelection(0)}},{key:"deleteHigher",value:function(){this._meshes.splice(this._sel+1)}},{key:"getLowIndexRender",value:function(){for(var t=this._sel;t>=0;){var e=this._meshes[t];if(!0===e.getEvenMapping())return t===this._sel?t:t+1;if(e.getNbTriangles()<5e5)return t;--t}return 0}},{key:"_renderLow",value:function(t){var e=this.getRenderData(),i=this._sel,r=this.getIndexBuffer();this.setSelection(this.getLowIndexRender()),e._indexBuffer=this._indexBuffer,Ze(Qe(o.prototype),"render",this).call(this,t),e._indexBuffer=r,this.setSelection(i)}},{key:"_renderWireframeLow",value:function(t){var e=this.getRenderData(),i=this._sel,r=this.getWireframeBuffer();this.setSelection(this.getLowIndexRender()),e._wireframeBuffer=this._wireframeBuffer,Ze(Qe(o.prototype),"renderWireframe",this).call(this,t),e._wireframeBuffer=r,this.setSelection(i)}},{key:"_canUseLowRender",value:function(t){return!(this.isUsingTexCoords()||this.isUsingDrawArrays()||o.RENDER_HINT===o.PICKING||o.RENDER_HINT===o.NONE||t.getMesh()===this&&o.RENDER_HINT!==o.CAMERA||this.getLowIndexRender()===this._sel)}},{key:"render",value:function(t){return this._canUseLowRender(t)?this._renderLow(t):Ze(Qe(o.prototype),"render",this).call(this,t)}},{key:"renderWireframe",value:function(t){return this._canUseLowRender(t)?this._renderWireframeLow(t):Ze(Qe(o.prototype),"renderWireframe",this).call(this,t)}}])&&Ge(e.prototype,i),r&&Ge(e,r),o}(Fe);$e.RENDER_HINT=0;const ti=$e;function ei(t){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ii(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ri(t,e){return(ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ni(t,e){return!e||"object"!==ei(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function si(t){return(si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const ai=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ri(t,e)}(a,t);var e,i,r,n,s=(r=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=si(r);if(n){var i=si(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return ni(this,t)});function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this))._mouseX=0,t._mouseY=0,t._lastMouseX=0,t._lastMouseY=0,t._lastScale=0,t._action=Ae.Action.NOTHING,t._lastNbPointers=0,t._isWheelingIn=!1,t._maskX=0,t._maskY=0,t._hammer=new de.Manager(t._canvas),t._eventProxy={},t.initHammer(),t.addEvents(),t}return e=a,(i=[{key:"addEvents",value:function(){var t=this._canvas,e=this.onMouseWheel.bind(this),i=this.onPointer.bind(this);t.addEventListener("pointerdown",i,!1),t.addEventListener("pointermove",i,!1),t.addEventListener("mousedown",this.onMouseDown.bind(this),!1),t.addEventListener("mouseup",this.onMouseUp.bind(this),!1),t.addEventListener("mouseout",this.onMouseOut.bind(this),!1),t.addEventListener("mouseover",this.onMouseOver.bind(this),!1),t.addEventListener("mousemove",xe.throttle(this.onMouseMove.bind(this),16.66),!1),t.addEventListener("mousewheel",e,!1),t.addEventListener("DOMMouseScroll",e,!1),window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1);var r=this.loadFiles.bind(this),n=this.stopAndPrevent.bind(this);t.addEventListener("webglcontextlost",this.onContextLost.bind(this),!1),t.addEventListener("webglcontextrestored",this.onContextRestored.bind(this),!1),window.addEventListener("dragenter",n,!1),window.addEventListener("dragover",n,!1),window.addEventListener("drop",r,!1),document.getElementById("fileopen").addEventListener("change",r,!1)}},{key:"onPointer",value:function(t){me.pressure=t.pressure}},{key:"initHammer",value:function(){this._hammer.options.enable=!0,this._initHammerRecognizers(),this._initHammerEvents()}},{key:"_initHammerRecognizers",value:function(){var t=this._hammer;t.add(new de.Tap({event:"doubletap",pointers:1,taps:2,time:250,interval:450,threshold:5,posThreshold:50})),t.add(new de.Tap({event:"doubletap2fingers",pointers:2,taps:2,time:250,interval:450,threshold:5,posThreshold:50})),t.add(new de.Pan({event:"pan",pointers:0,threshold:0})),t.add(new de.Pinch({event:"pinch",pointers:2,threshold:.1})),t.get("pinch").recognizeWith(t.get("pan"))}},{key:"_initHammerEvents",value:function(){var t=this._hammer;t.on("panstart",this.onPanStart.bind(this)),t.on("panmove",this.onPanMove.bind(this)),t.on("panend pancancel",this.onPanEnd.bind(this)),t.on("doubletap",this.onDoubleTap.bind(this)),t.on("doubletap2fingers",this.onDoubleTap2Fingers.bind(this)),t.on("pinchstart",this.onPinchStart.bind(this)),t.on("pinchin pinchout",this.onPinchInOut.bind(this))}},{key:"stopAndPrevent",value:function(t){t.stopPropagation(),t.preventDefault()}},{key:"onContextLost",value:function(){window.alert("Oops... WebGL context lost.")}},{key:"onContextRestored",value:function(){window.alert("Wow... Context is restored.")}},{key:"onKeyDown",value:function(t){this._gui.callFunc("onKeyDown",t)}},{key:"onKeyUp",value:function(t){this._gui.callFunc("onKeyUp",t)}},{key:"onPanStart",value:function(t){if("mouse"!==t.pointerType){this._focusGui=!1;var e=this._eventProxy;e.pageX=t.center.x,e.pageY=t.center.y,this.onPanUpdateNbPointers(Math.min(3,t.pointers.length))}}},{key:"onPanMove",value:function(t){if("mouse"!==t.pointerType){var e=this._eventProxy;e.pageX=t.center.x,e.pageY=t.center.y;var i=Math.min(3,t.pointers.length);i!==this._lastNbPointers&&(this.onDeviceUp(),this.onPanUpdateNbPointers(i)),this.onDeviceMove(e),this._isIOS()&&(window.clearTimeout(this._timerResetPointer),this._timerResetPointer=window.setTimeout(function(){this._lastNbPointers=0}.bind(this),60))}}},{key:"_isIOS",value:function(){return void 0!==this._isIOS||(this._isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)),this._isIOS}},{key:"onPanUpdateNbPointers",value:function(t){var e=this._eventProxy;e.which=1===t&&this._lastNbPointers>=1?3:t,this._lastNbPointers=t,this.onDeviceDown(e)}},{key:"onPanEnd",value:function(t){"mouse"!==t.pointerType&&(this.onDeviceUp(),window.setTimeout(function(){t.pointers.length||(this._lastNbPointers=0)}.bind(this),60))}},{key:"onDoubleTap",value:function(t){if(!this._focusGui){var e=this._eventProxy;e.pageX=t.center.x,e.pageY=t.center.y,this.setMousePosition(e);var i=this._picking,r=i.intersectionMouseMeshes(),n=this._camera,s=[0,0,0];if(!r)return this.resetCameraMeshes();pe(s,i.getIntersectionPoint(),i.getMesh().getMatrix());var a=n._trans[2];n.isOrthographic()||(a=Math.min(a,(o=s,u=n.computePosition(),Math.hypot(o[0]-u[0],o[1]-u[1],o[2]-u[2])))),n.setAndFocusOnPivot(s,a),this.render()}var o,u}},{key:"onDoubleTap2Fingers",value:function(){this._focusGui||this.resetCameraMeshes()}},{key:"onPinchStart",value:function(t){this._focusGui=!1,this._lastScale=t.scale}},{key:"onPinchInOut",value:function(t){var e=25*(t.scale-this._lastScale);this._lastScale=t.scale,this.onDeviceWheel(e)}},{key:"resetCameraMeshes",value:function(t){if(t||(t=this._meshes),t.length>0){var e=[0,0,0],i=this.computeBoundingBoxMeshes(t),r=.8*this.computeRadiusFromBoundingBox(i);r*=this._camera.computeFrustumFit(),ye(e,.5*(i[0]+i[3]),.5*(i[1]+i[4]),.5*(i[2]+i[5])),this._camera.setAndFocusOnPivot(e,r)}else this._camera.resetView();this.render()}},{key:"getFileType",value:function(t){var e=t.toLowerCase();return e.endsWith(".obj")?"obj":e.endsWith(".sgl")?"sgl":e.endsWith(".stl")?"stl":e.endsWith(".ply")?"ply":void 0}},{key:"loadFiles",value:function(t){t.stopPropagation(),t.preventDefault();for(var e=t.dataTransfer?t.dataTransfer.files:t.target.files,i=0,r=e.length;i<r;++i){var n=e[i],s=this.getFileType(n.name);this.readFile(n,s)}}},{key:"readFile",value:function(t,e){var i=e||this.getFileType(t.name);if(i){var r=new FileReader,n=this;r.onload=function(t){n.loadScene(t.target.result,i),document.getElementById("fileopen").value=""},"obj"===i?r.readAsText(t):r.readAsArrayBuffer(t)}}},{key:"onMouseDown",value:function(t){t.stopPropagation(),t.preventDefault(),this._gui.callFunc("onMouseDown",t),this.onDeviceDown(t)}},{key:"onMouseMove",value:function(t){t.stopPropagation(),t.preventDefault(),this._gui.callFunc("onMouseMove",t),this.onDeviceMove(t)}},{key:"onMouseOver",value:function(t){this._focusGui=!1,this._gui.callFunc("onMouseOver",t)}},{key:"onMouseOut",value:function(t){this._focusGui=!0,this._gui.callFunc("onMouseOut",t),this.onMouseUp(t)}},{key:"onMouseUp",value:function(t){t.preventDefault(),this._gui.callFunc("onMouseUp",t),this.onDeviceUp()}},{key:"onMouseWheel",value:function(t){t.stopPropagation(),t.preventDefault(),this._gui.callFunc("onMouseWheel",t);var e=void 0===t.wheelDelta?-t.detail:t.wheelDelta;this.onDeviceWheel(e>0?1:-1)}},{key:"onDeviceUp",value:function(){this.setCanvasCursor("default"),ti.RENDER_HINT=ti.NONE,this._sculptManager.end(),this._action===Ae.Action.MASK_EDIT&&this._mesh&&(this._lastMouseX===this._maskX&&this._lastMouseY===this._maskY?this.getSculptManager().getTool(Ae.Tools.MASKING).invert():this.getSculptManager().getTool(Ae.Tools.MASKING).clear()),this._action=Ae.Action.NOTHING,this.render(),this._stateManager.cleanNoop()}},{key:"onDeviceWheel",value:function(t){t>0&&!this._isWheelingIn&&(this._isWheelingIn=!0,this._camera.start(this._mouseX,this._mouseY)),this._camera.zoom(.02*t),ti.RENDER_HINT=ti.CAMERA,this.render(),this._timerEndWheel&&window.clearTimeout(this._timerEndWheel),this._timerEndWheel=window.setTimeout(this._endWheel.bind(this),300)}},{key:"_endWheel",value:function(){ti.RENDER_HINT=ti.NONE,this._isWheelingIn=!1,this.render()}},{key:"setMousePosition",value:function(t){this._mouseX=this._pixelRatio*(t.pageX-this._canvasOffsetLeft),this._mouseY=this._pixelRatio*(t.pageY-this._canvasOffsetTop)}},{key:"onDeviceDown",value:function(t){if(!this._focusGui){this.setMousePosition(t);var e=this._mouseX,i=this._mouseY,r=t.which,n=!1;1===r&&(n=this._sculptManager.start(t.shiftKey||this._multiSelection)),1===r&&n&&this.setCanvasCursor("none"),3===r&&t.ctrlKey?this._action=Ae.Action.CAMERA_ZOOM:2===r?this._action=Ae.Action.CAMERA_PAN:!n&&t.ctrlKey?(this._maskX=e,this._maskY=i,this._action=Ae.Action.MASK_EDIT):n&&3!==r||!t.altKey?this._action=3===r||1===r&&!n?Ae.Action.CAMERA_ROTATE:Ae.Action.SCULPT_EDIT:this._action=Ae.Action.CAMERA_PAN_ZOOM_ALT,this._action!==Ae.Action.CAMERA_ROTATE&&this._action!==Ae.Action.CAMERA_ZOOM||this._camera.start(e,i),this._lastMouseX=e,this._lastMouseY=i}}},{key:"getSpeedFactor",value:function(){return this._cameraSpeed/(this._canvasHeight*this.getPixelRatio())}},{key:"onDeviceMove",value:function(t){if(!this._focusGui){this.setMousePosition(t);var e=this._mouseX,i=this._mouseY,r=this._action,n=this.getSpeedFactor();r===Ae.Action.CAMERA_ZOOM||r===Ae.Action.CAMERA_PAN_ZOOM_ALT&&!t.altKey?(ti.RENDER_HINT=ti.CAMERA,this._camera.zoom((e-this._lastMouseX+i-this._lastMouseY)*n),this.render()):r===Ae.Action.CAMERA_PAN_ZOOM_ALT||r===Ae.Action.CAMERA_PAN?(ti.RENDER_HINT=ti.CAMERA,this._camera.translate((e-this._lastMouseX)*n,(i-this._lastMouseY)*n),this.render()):r===Ae.Action.CAMERA_ROTATE?(ti.RENDER_HINT=ti.CAMERA,t.shiftKey||this._camera.rotate(e,i),this.render()):(ti.RENDER_HINT=ti.PICKING,this._sculptManager.preUpdate(),r===Ae.Action.SCULPT_EDIT&&(ti.RENDER_HINT=ti.SCULPT,this._sculptManager.update(this),this.getMesh().isDynamic&&this._gui.updateMeshInfo())),this._lastMouseX=e,this._lastMouseY=i,this.renderSelectOverRtt()}}}])&&ii(e.prototype,i),a}(Se);window.SculptGL=ai},297:(t,e,i)=>{var r;function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(s,a,o,u){"use strict";var h,l=["","webkit","Moz","MS","ms","o"],c=a.createElement("div"),f=Math.round,y=Math.abs,p=Date.now;function d(t,e,i){return setTimeout(x(t,i),e)}function v(t,e,i){return!!Array.isArray(t)&&(m(t,i[e],i),!0)}function m(t,e,i){var r;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==u)for(r=0;r<t.length;)e.call(i,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(i,t[r],r,t)}function g(t,e,i){var r="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",n=s.console&&(s.console.warn||s.console.log);return n&&n.call(s.console,r,i),t.apply(this,arguments)}}h="function"!=typeof Object.assign?function(t){if(t===u||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var r=arguments[i];if(r!==u&&null!==r)for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e}:Object.assign;var _=g((function(t,e,i){for(var r=Object.keys(e),n=0;n<r.length;)(!i||i&&t[r[n]]===u)&&(t[r[n]]=e[r[n]]),n++;return t}),"extend","Use `assign`."),b=g((function(t,e){return _(t,e,!0)}),"merge","Use `assign`.");function k(t,e,i){var r,n=e.prototype;(r=t.prototype=Object.create(n)).constructor=t,r._super=n,i&&h(r,i)}function x(t,e){return function(){return t.apply(e,arguments)}}function M(t,e){return"function"==n(t)?t.apply(e&&e[0]||u,e):t}function w(t,e){return t===u?e:t}function A(t,e,i){m(C(e),(function(e){t.addEventListener(e,i,!1)}))}function T(t,e,i){m(C(e),(function(e){t.removeEventListener(e,i,!1)}))}function S(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function E(t,e){return t.indexOf(e)>-1}function C(t){return t.trim().split(/\s+/g)}function R(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var r=0;r<t.length;){if(i&&t[r][i]==e||!i&&t[r]===e)return r;r++}return-1}function I(t){return Array.prototype.slice.call(t,0)}function N(t,e,i){for(var r=[],n=[],s=0;s<t.length;){var a=e?t[s][e]:t[s];R(n,a)<0&&r.push(t[s]),n[s]=a,s++}return i&&(r=e?r.sort((function(t,i){return t[e]>i[e]})):r.sort()),r}function z(t,e){for(var i,r,n=e[0].toUpperCase()+e.slice(1),s=0;s<l.length;){if((r=(i=l[s])?i+n:e)in t)return r;s++}return u}var O=1;function F(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||s}var P="ontouchstart"in s,V=z(s,"PointerEvent")!==u,D=P&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),U="touch",L="mouse",W=["x","y"],B=["clientX","clientY"];function j(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){M(t.options.enable,[t])&&i.handler(e)},this.init()}function X(t,e,i){var r=i.pointers.length,n=i.changedPointers.length,s=1&e&&r-n==0,a=12&e&&r-n==0;i.isFirst=!!s,i.isFinal=!!a,s&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,r=e.pointers,n=r.length;i.firstInput||(i.firstInput=Y(e)),n>1&&!i.firstMultiple?i.firstMultiple=Y(e):1===n&&(i.firstMultiple=!1);var s=i.firstInput,a=i.firstMultiple,o=a?a.center:s.center,h=e.center=H(r);e.timeStamp=p(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=K(o,h),e.distance=Z(o,h),function(t,e){var i=e.center,r=t.offsetDelta||{},n=t.prevDelta||{},s=t.prevInput||{};1!==e.eventType&&4!==s.eventType||(n=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},r=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=n.x+(i.x-r.x),e.deltaY=n.y+(i.y-r.y)}(i,e),e.offsetDirection=G(e.deltaX,e.deltaY);var l,c,f=q(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=f.x,e.overallVelocityY=f.y,e.overallVelocity=y(f.x)>y(f.y)?f.x:f.y,e.scale=a?(l=a.pointers,Z((c=r)[0],c[1],B)/Z(l[0],l[1],B)):1,e.rotation=a?function(t,e){return K(e[1],e[0],B)+K(t[1],t[0],B)}(a.pointers,r):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,r,n,s,a=t.lastInterval||e,o=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(o>25||a.velocity===u)){var h=e.deltaX-a.deltaX,l=e.deltaY-a.deltaY,c=q(o,h,l);r=c.x,n=c.y,i=y(c.x)>y(c.y)?c.x:c.y,s=G(h,l),t.lastInterval=e}else i=a.velocity,r=a.velocityX,n=a.velocityY,s=a.direction;e.velocity=i,e.velocityX=r,e.velocityY=n,e.direction=s}(i,e);var d=t.element;S(e.srcEvent.target,d)&&(d=e.srcEvent.target),e.target=d}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function Y(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:f(t.pointers[i].clientX),clientY:f(t.pointers[i].clientY)},i++;return{timeStamp:p(),pointers:e,center:H(e),deltaX:t.deltaX,deltaY:t.deltaY}}function H(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};for(var i=0,r=0,n=0;n<e;)i+=t[n].clientX,r+=t[n].clientY,n++;return{x:f(i/e),y:f(r/e)}}function q(t,e,i){return{x:e/t||0,y:i/t||0}}function G(t,e){return t===e?1:y(t)>=y(e)?t<0?2:4:e<0?8:16}function Z(t,e,i){i||(i=W);var r=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return Math.sqrt(r*r+n*n)}function K(t,e,i){i||(i=W);var r=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return 180*Math.atan2(n,r)/Math.PI}j.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(F(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(F(this.element),this.evWin,this.domHandler)}};var J={mousedown:1,mousemove:2,mouseup:4},Q="mousedown",$="mousemove mouseup";function tt(){this.evEl=Q,this.evWin=$,this.pressed=!1,j.apply(this,arguments)}k(tt,j,{handler:function(t){var e=J[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:L,srcEvent:t}))}});var et={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},it={2:U,3:"pen",4:L,5:"kinect"},rt="pointerdown",nt="pointermove pointerup pointercancel";function st(){this.evEl=rt,this.evWin=nt,j.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}s.MSPointerEvent&&!s.PointerEvent&&(rt="MSPointerDown",nt="MSPointerMove MSPointerUp MSPointerCancel"),k(st,j,{handler:function(t){var e=this.store,i=!1,r=t.type.toLowerCase().replace("ms",""),n=et[r],s=it[t.pointerType]||t.pointerType,a=s==U,o=R(e,t.pointerId,"pointerId");1&n&&(0===t.button||a)?o<0&&(e.push(t),o=e.length-1):12&n&&(i=!0),o<0||(e[o]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),i&&e.splice(o,1))}});var at={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ot="touchstart",ut="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=ot,this.evWin=ut,this.started=!1,j.apply(this,arguments)}function lt(t,e){var i=I(t.touches),r=I(t.changedTouches);return 12&e&&(i=N(i.concat(r),"identifier",!0)),[i,r]}k(ht,j,{handler:function(t){var e=at[t.type];if(1===e&&(this.started=!0),this.started){var i=lt.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:U,srcEvent:t})}}});var ct={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ft="touchstart touchmove touchend touchcancel";function yt(){this.evTarget=ft,this.targetIds={},j.apply(this,arguments)}function pt(t,e){var i=I(t.touches),r=this.targetIds;if(3&e&&1===i.length)return r[i[0].identifier]=!0,[i,i];var n,s,a=I(t.changedTouches),o=[],u=this.target;if(s=i.filter((function(t){return S(t.target,u)})),1===e)for(n=0;n<s.length;)r[s[n].identifier]=!0,n++;for(n=0;n<a.length;)r[a[n].identifier]&&o.push(a[n]),12&e&&delete r[a[n].identifier],n++;return o.length?[N(s.concat(o),"identifier",!0),o]:void 0}function dt(){j.apply(this,arguments);var t=x(this.handler,this);this.touch=new yt(this.manager,t),this.mouse=new tt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function vt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,mt.call(this,e)):12&t&&mt.call(this,e)}function mt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(i);t>-1&&r.splice(t,1)}),2500)}}function gt(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var n=this.lastTouches[r],s=Math.abs(e-n.x),a=Math.abs(i-n.y);if(s<=25&&a<=25)return!0}return!1}k(yt,j,{handler:function(t){var e=ct[t.type],i=pt.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:U,srcEvent:t})}}),k(dt,j,{handler:function(t,e,i){var r=i.pointerType==U,n=i.pointerType==L;if(!(n&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(r)vt.call(this,e,i);else if(n&&gt.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _t=z(c.style,"touchAction"),bt=_t!==u,kt="compute",xt="auto",Mt="manipulation",wt="none",At="pan-x",Tt="pan-y",St=function(){if(!bt)return!1;var t={},e=s.CSS&&s.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){t[i]=!e||s.CSS.supports("touch-action",i)})),t}();function Et(t,e){this.manager=t,this.set(e)}Et.prototype={set:function(t){t==kt&&(t=this.compute()),bt&&this.manager.element.style&&St[t]&&(this.manager.element.style[_t]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){M(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(E(t,wt))return wt;var e=E(t,At),i=E(t,Tt);return e&&i?wt:e||i?e?At:Tt:E(t,Mt)?Mt:xt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,n=E(r,wt)&&!St.none,s=E(r,Tt)&&!St["pan-y"],a=E(r,At)&&!St["pan-x"];if(n){var o=1===t.pointers.length,u=t.distance<2,h=t.deltaTime<250;if(o&&u&&h)return}if(!a||!s)return n||s&&6&i||a&&24&i?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ct=32;function Rt(t){this.options=h({},this.defaults,t||{}),this.id=O++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function It(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Nt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function zt(t,e){var i=e.manager;return i?i.get(t):t}function Ot(){Rt.apply(this,arguments)}function Ft(){Ot.apply(this,arguments),this.pX=null,this.pY=null}function Pt(){Ot.apply(this,arguments)}function Vt(){Rt.apply(this,arguments),this._timer=null,this._input=null}function Dt(){Ot.apply(this,arguments)}function Ut(){Ot.apply(this,arguments)}function Lt(){Rt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Wt(t,e){return(e=e||{}).recognizers=w(e.recognizers,Wt.defaults.preset),new Bt(t,e)}function Bt(t,e){this.options=h({},Wt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(V?st:D?yt:P?dt:tt))(this,X),this.touchAction=new Et(this,this.options.touchAction),jt(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function jt(t,e){var i,r=t.element;r.style&&(m(t.options.cssProps,(function(n,s){i=z(r.style,s),e?(t.oldCssProps[i]=r.style[i],r.style[i]=n):r.style[i]=t.oldCssProps[i]||""})),e||(t.oldCssProps={}))}Rt.prototype={defaults:{},set:function(t){return h(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(v(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=zt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return v(t,"dropRecognizeWith",this)||(t=zt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(v(t,"requireFailure",this))return this;var e=this.requireFail;return-1===R(e,t=zt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(v(t,"dropRequireFailure",this))return this;t=zt(t,this);var e=R(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,i=this.state;function r(i){e.manager.emit(i,t)}i<8&&r(e.options.event+It(i)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),i>=8&&r(e.options.event+It(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Ct},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=h({},t);if(!M(this.options.enable,[this,e]))return this.reset(),void(this.state=Ct);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},k(Ot,Rt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,r=6&e,n=this.attrTest(t);return r&&(8&i||!n)?16|e:r||n?4&i?8|e:2&e?4|e:2:Ct}}),k(Ft,Ot,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(Tt),24&t&&e.push(At),e},directionTest:function(t){var e=this.options,i=!0,r=t.distance,n=t.direction,s=t.deltaX,a=t.deltaY;return n&e.direction||(6&e.direction?(n=0===s?1:s<0?2:4,i=s!=this.pX,r=Math.abs(t.deltaX)):(n=0===a?1:a<0?8:16,i=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=n,i&&r>e.threshold&&n&e.direction},attrTest:function(t){return Ot.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Nt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),k(Pt,Ot,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[wt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),k(Vt,Rt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,r=t.distance<e.threshold,n=t.deltaTime>e.time;if(this._input=t,!r||!i||12&t.eventType&&!n)this.reset();else if(1&t.eventType)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Ct},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),k(Dt,Ot,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[wt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),k(Ut,Ot,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Ft.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return 30&i?e=t.overallVelocity:6&i?e=t.overallVelocityX:24&i&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&y(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Nt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),k(Lt,Rt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Mt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,r=t.distance<e.threshold,n=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&n&&i){if(4!=t.eventType)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||Z(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Ct},failTimeout:function(){return this._timer=d((function(){this.state=Ct}),this.options.interval,this),Ct},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Wt.VERSION="2.0.7",Wt.defaults={domEvents:!1,touchAction:kt,enable:!0,inputTarget:null,inputClass:null,preset:[[Dt,{enable:!1}],[Pt,{enable:!1},["rotate"]],[Ut,{direction:6}],[Ft,{direction:6},["swipe"]],[Lt],[Lt,{event:"doubletap",taps:2},["tap"]],[Vt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Bt.prototype={set:function(t){return h(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var r=this.recognizers,n=e.curRecognizer;(!n||n&&8&n.state)&&(n=e.curRecognizer=null);for(var s=0;s<r.length;)i=r[s],2===e.stopped||n&&i!=n&&!i.canRecognizeWith(n)?i.reset():i.recognize(t),!n&&14&i.state&&(n=e.curRecognizer=i),s++}},get:function(t){if(t instanceof Rt)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(v(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(v(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=R(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==u&&e!==u){var i=this.handlers;return m(C(t),(function(t){i[t]=i[t]||[],i[t].push(e)})),this}},off:function(t,e){if(t!==u){var i=this.handlers;return m(C(t),(function(t){e?i[t]&&i[t].splice(R(i[t],e),1):delete i[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var i=a.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<i.length;)i[r](e),r++}},destroy:function(){this.element&&jt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(Wt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ct,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Bt,Input:j,TouchAction:Et,TouchInput:yt,MouseInput:tt,PointerEventInput:st,TouchMouseInput:dt,SingleTouchInput:ht,Recognizer:Rt,AttrRecognizer:Ot,Tap:Lt,Pan:Ft,Swipe:Ut,Pinch:Pt,Rotate:Dt,Press:Vt,on:A,off:T,each:m,merge:b,extend:_,assign:h,inherit:k,bindFn:x,prefixed:z}),(void 0!==s?s:"undefined"!=typeof self?self:{}).Hammer=Wt,(r=function(){return Wt}.call(e,i,e,t))===u||(t.exports=r)}(window,document)},50:()=>{if(window.Map||(window.Map=function(){this.map={}},window.Map.prototype={set:function(t,e){this.map[t]=e},get:function(t){return this.map[t]}}),!Float32Array.prototype.slice){var t=function(t,e){return new this.constructor(this.subarray(t,e))};Int8Array.prototype.slice=t,Uint8Array.prototype.slice=t,Uint8ClampedArray.prototype.slice=t,Int16Array.prototype.slice=t,Uint16Array.prototype.slice=t,Int32Array.prototype.slice=t,Uint32Array.prototype.slice=t,Float32Array.prototype.slice=t,Float64Array.prototype.slice=t}String.prototype.endsWith||(String.prototype.endsWith=function(t){return this.slice(-t.length)===t}),String.prototype.startsWith||(String.prototype.startsWith=function(t){return this.slice(0,t.length)===t});for(var e=["moz","webkit"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"];window.requestAnimationFrame||window.alert("browser is too old. Probably no webgl there anyway")}},e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={exports:{}};return t[r](n,n.exports,i),n.exports}return i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i(750)})()}));